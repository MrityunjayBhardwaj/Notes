var conf={};conf.strQty=strQuantity;var dom={headerContainer:"",itemsContainer:"",items:{}},templates={},render={},presenters={},events={},models={itemType:"MR",items:{},venue:{id:"BSTR"},itemCategory:{tshirt:1,toy:2},tShirtItemIds:["1003065","1003066","1003067","1003068","1003069","1003070","1003071","1003072","1003073","1003074","1003075","1003076","1003077"]};function openRewardPreview(){try{var e=JSON.stringify({bookingId:strBookingId,open:!0});BMS.Storage.set({name:"rewardsModal",value:e,storage:"L"}),conf.fnOpenReward(reward.redirectionUrl)}catch(e){BMS.Misc.fnErr({fnName:"openRewardPreview",err:e})}}function initiateRewardPopup(){try{var e=BMS.Storage.get({name:"rewardsModal",storage:"L"}),t=e&&e.length?JSON.parse(e):null,n=!0;if(t){var o=t.bookingId,i=t.open;n=o===strBookingId&&!i}if(reward&&"Y"===reward.showPopup&&n){$(".reward-modal-image").css({"background-image":'url("'+reward.cbImage+'")'});var s=$(".reward-modal-label");s.html(reward.text),s.css({color:reward.textColor});var r=$(".reward-modal-sub-label");r.html(reward.subText),r.css({color:reward.subTextColor});var a=$(".reward-modal-button");a.css({color:reward.cbTextColor,backgroundColor:reward.cbBgColor}),a.html(reward.cbText),a.click((function(){openRewardPreview()}));var c=$(".rewards-modal-wrapper");c.css({"background-color":reward.backgroundColor}),c.click((function(){openRewardPreview()})),c.addClass("rewards-modal-popup"),document.getElementsByTagName("html")[0].style.overflow="hidden",$(".rewards-modal-overlay").click((function(){c.addClass("rewards-modal-hide"),setTimeout((function(){$(".rewards-modal").css({visibility:"hidden"})}),400),document.getElementsByTagName("html")[0].style.overflow="scroll"}))}else{var d=$(".rewards-modal");d&&d.remove()}$(".reward-touch-container").css({display:"flex"})}catch(e){BMS.Misc.fnErr({fnName:"initiateRewardPopup",err:e})}}function fnClSur(t,e,n,o,i,s,r){try{var a="",c="";"clSur"==t?(a="C",c="NPS_Crossmark"):"SkipSur"==t&&(a="N",c="May be later sometime");var d={Score:"",Group:"","Email ID":o,Response:"",Mobile:i,TransID:e,Reason:"",Action:a,Comment:"",Appcode:global.strAppCode};BMS.Misc.fnPushEventDataToAnalytics(["WR"],"NPS",d),BMS.Misc.fnAjax({data:{cmd:"SAVENPSDATA",data:{emailId:o,mobile:i,transId:e,response:"NA",eventType:r,reason:"",action:a,token:"",appCode:global.strAppCode,surveyId:1,deviceDetails:"undefined"!=typeof objNPSDeviceDetails?objNPSDeviceDetails:""}},dataType:"JSON",type:"POST",success:function(e){"undefined"!=typeof npsMobFlag&&!0===npsMobFlag?"clSur"==t?window.location="http://in.bookmyshow.com/survey/nps.bms?cmd=cancel":"SkipSur"==t&&(window.location="http://in.bookmyshow.com/survey/nps.bms?cmd=skip"):BMS.Misc.modal("dRatConf",!1)},error:function(e){"undefined"!=typeof npsMobFlag&&!0===npsMobFlag?"clSur"==t?window.location="http://in.bookmyshow.com/survey/nps.bms?cmd=cancel":"SkipSur"==t&&(window.location="http://in.bookmyshow.com/survey/nps.bms?cmd=skip"):BMS.Misc.modal("dRatConf",!1)},url:global.getDataUrl+"?cmd=NEWSURVEY"});var l={event:"tvc_gtmstdevent_nps_tracking",app_code:"web",eventCategory:"NPS_web",eventAction:c};BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",null,l)}catch(e){BMS.Misc.modal("dRatConf",!1)}}function fnShowSurvey(e,t){try{BMS.Misc.fnAjax({data:{surveyId:1,emailId:e,mobile:t,cmd:"CHECKSURVEY"},dataType:"JSON",type:"POST",success:function(e){if("Y"==e.data.survey&&0==e.error.code){if("undefined"==typeof npsMobFlag||!0!==npsMobFlag){BMS.Misc.modal("dRatConf",!0),$("#ans li input[type='radio']").unbind("click"),$("#ans li input[type='radio']").click((function(){$("#selNpsLowReason, #selNpsMediumReason").val("1"),$("#dNPSCommentSec").hide(),$("#ans span").removeClass("_active"),$("#ans #npsAns_"+$(this).val()+" span").addClass("_active"),$("#errSurvey").hide(),1<=$(this).val()&&$(this).val()<=6?$("#npsLowReason").show():$("#npsLowReason").hide(),7<=$(this).val()&&$(this).val()<=8?($("#npsMediumFeedback").show(),$("#txtMediumFeedback").focus()):$("#npsMediumFeedback").hide(),9<=$(this).val()&&$(this).val()<=10?$("#dNPSCommentSec").show():$("#dNPSCommentSec").hide(),$("#spnNPSCommentLabelLow, #spnNPSCommentLabelHigh").hide(),1<=$(this).val()&&$(this).val()<=8?$("#spnNPSCommentLabelLow").show():$("#spnNPSCommentLabelHigh").show(),$("#selNpsLowReason, #selNpsMediumReason").unbind("change"),$("#selNpsLowReason, #selNpsMediumReason").change((function(){"1"==$(this).val()?$("#dNPSCommentSec").hide():$("#dNPSCommentSec").show(),BMS.Misc.fnDoFloat()}))}));var t="",n="",o="";if(0<e.data.options[0].low.length)for(var i in e.data.options[0].low[0])t+="<option value='"+i+"'>"+e.data.options[0].low[0][i]+"</option>";if($("#selNpsLowReason").html(t),0<e.data.options[0].medium.length)for(var s in e.data.options[0].medium[0])n+="<option value='"+s+"'>"+e.data.options[0].medium[0][s]+"</option>";if($("#selNpsMediumReason").html(n),0<e.data.options[0].high.length)for(var r in e.data.options[0].high[0])o+="<option value='"+r+"'>"+e.data.options[0].high[0][r]+"</option>";return void $("#selNpsHighReason").html(o)}BMS.Misc.modal("dRatConf",!0),$("#ans li input[type='radio']").unbind("click"),$("#ans li input[type='radio']").click((function(){$("#errSurvey").hide(),1<=$(this).val()&&$(this).val()<=6?$("#npsLowReason").show():$("#npsLowReason").hide(),7<=$(this).val()&&$(this).val()<=8?($("#npsMediumFeedback").show(),$("#txtMediumFeedback").focus()):$("#npsMediumFeedback").hide()}))}else"N"==e.data.survey&&("undefined"!=typeof npsMobFlag&&!0===npsMobFlag&&(window.location="http://in.bookmyshow.com/survey/nps.bms?cmd=hide"),showWhatsAppOptIn())},url:global.getDataUrl+"?cmd=NEWSURVEY",error:function(e){void 0}})}catch(e){void 0}}function fnSSur(e,t,n,o,i,s){try{$("#errSurvey").hide();var r={};if(""==$("#ans input[name='rating']:checked").val()||null==$("#ans input[name='rating']:checked").val())return void BMS.Misc.fnSCusErrDisplay("errSurvey","Please rate to complete the survey.","e");var a=parseInt($("#ans input[name='rating']:checked").val(),10);if(1<=a&&a<=6&&1==$("#selNpsLowReason").val())return void BMS.Misc.fnSCusErrDisplay("errSurvey","Please select the areas we need to improve upon","e");if(7<=a&&a<=8&&1==$("#selNpsMediumReason").val())return void BMS.Misc.fnSCusErrDisplay("errSurvey","Please select the areas we need to improve upon","e");$.trim($("#question").text()),r.response1=$("#ans input[name='rating']:checked").val(),$("#btnSurveyCancel").hide(),$("#btnSurveySubmit").html("Processing...").removeAttr("onclick");var c=r.response1,d="",l="",f="";1<=a&&a<=6?(d=$("#selNpsLowReason").val(),l=$("#selNpsLowReason option:selected").text(),f="Passive"):7<=a&&a<=8?(d=$("#selNpsMediumReason").val(),l=$("#selNpsMediumReason option:selected").text(),f="Detractor"):f="Promoter",BMS.Misc.fnAjax({data:{cmd:"SAVENPSDATA",data:{emailId:n,mobile:o,transId:e,response:c,eventType:s,reason:d,action:"S",token:"",appCode:global.strAppCode,surveyId:1,deviceDetails:"undefined"!=typeof objNPSDeviceDetails?objNPSDeviceDetails:"",comment:0!=$("#txtNPSComment").length?$("#txtNPSComment").val():""}},dataType:"JSON",type:"POST",success:function(e){var t="";"undefined"!=typeof npsMobFlag&&!0===npsMobFlag?window.location="http://in.bookmyshow.com/survey/nps.bms?cmd=rate":($("#question").hide(),t='<div><span style="font-size:24px;line-height:30px;"><img src="//in.bmscdn.com/webin/static/npsdone.png"  style="width: 80px;"></br>Thank you.</span><div class="sbmt_nxt"><a href="javascript:;" style="font-size:15px;padding:5px;" class="button yellow" onClick=\'BMS.Misc.modal("dRatConf", false);\'>Close</a></div></div>'),$("#sucSurvey").html(t)},error:function(e){var t="";"undefined"!=typeof npsMobFlag&&!0===npsMobFlag?window.location="http://in.bookmyshow.com/survey/nps.bms?cmd=rate":($("#question").hide(),t='<div><span style="font-size:24px;line-height:30px;"><img src="//in.bmscdn.com/webin/static/npsdone.png"  style="width: 80px;"></br>Thank you.</span><div class="sbmt_nxt"><a href="javascript:;" style="font-size:15px;padding:5px;" class="button yellow" onClick=\'BMS.Misc.modal("dRatConf", false);\'>Close</a></div></div>'),$("#sucSurvey").html(t)},url:global.getDataUrl+"?cmd=NEWSURVEY"});var p=$.trim($("#txtNPSComment").val()),u={event:"tvc_gtmstdevent_nps_tracking",app_code:"web",eventCategory:"NPS_web",eventAction:"Submit_NO ("+c+")",eventLabel:p},m={Score:a,Group:f,"Email ID":n,Response:c,Mobile:o,TransID:e,Reason:l,Action:"S",Comment:p,Appcode:global.strAppCode};""!=l&&(u.eventLabel=l+(0!=p.length?" | "+p:"")),BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",null,u),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"NPS",m)}catch(e){BMS.Misc.modal("dRatConf",!1)}}conf.couponDetailsData=[],templates.header='<span class="__title">Top 5 Star Wars merchandise</span>    <a class="__view-all" href="/merchandise/star-wars/">View All</a>',templates.item='<div class="bxcnt _items js-item">    <div class="mrcitem wow fadeIn">        <div class="_bg">            <img data-src="{{imageURL}}" data-mobile="{{imageURL}}" data-error="//in.bmscdn.com/webin/static/default.jpg">            <div class="_bghover">                <img data-src="{{hoverImageURL}}" data-mobile="{{hoverImageURL}}" data-error="//in.bmscdn.com/webin/static/default.jpg">            </div>        </div>        <div class="imghove"></div>        <div id="marinfo">            <div class="_itemname">{{name}}</div>            <div class="_itemsubname">{{description}}</div>            <div class="__item-price">Rs. {{price}}</div>        </div>        <div class="mpri">            <a href="/merchandise/star-wars/" class="button" data-item-id="{{itemId}}">Buy Now</a>        </div>    </div></div>',conf.fnPgLd=function(){try{conf.ActionBusy=$("[data-id=actions-div]"),$("[data-role=mobile]").keydown((function(e){for(var t=e.which?e.which:e.keyCode,n=[8,13,46,37,38,39,40,9],o=48;o<=57;o++)n.push(o);for(o=96;o<=105;o++)n.push(o);return-1<$.inArray(t,n)||!!e.ctrlKey})),"undefined"!=typeof strVenueCode&&"undefined"!=typeof lngSessionId&&strVenueCode&&lngSessionId&&(BMS.Storage.set({name:"userCine",key:"lastVC",value:strVenueCode,storage:"C"}),BMS.Storage.set({name:"userCine",key:"lastSID",value:lngSessionId,storage:"C"})),1==starWarsFlag&&conf.getInventory(),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"Reward Pop Up",{Eligible:0<Object.keys(reward).length?"Yes":"No","Reward Id":reward&&reward.referenceId?reward.referenceId:"",Clicked:"No","Logged In":""!=BMS.Storage.get({name:"ld"})?"Yes":"No",Appcode:global.strAppCode})}catch(e){BMS.Misc.fnErr({fnName:"conf.fnPgLd",err:e})}},conf.getInventory=function(){dom.headerContainer=$(".ev-header"),dom.itemsContainer=$(".ev-cards"),dom.headerContainer.append(templates.header),BMS.Misc.fnBusy(!0,dom.itemsContainer),BMS.Misc.fnAjax({url:"/serv/getData",type:"GET",dataType:"json",data:{cmd:"GETFOODCOMBO",type:models.itemType,vid:models.venue.id,dataType:"json"},success:function(e){conf.processAPIResponse(e)},error:function(e){}})},conf.processAPIResponse=function(e){_.isEmpty(e)?void 0:(models.items=models.getItems(e),render.items())},models.getItems=function(e){var t=e.BookMyShow.arFC,n={};return _.isEmpty(t)||t.forEach((function(e){var t=e.ItemCode;$.isEmptyObject(n[t])&&(n[t]={id:t,name:e.ItemSN,description:e.ItemDesc,price:e.ItemSell,imageURL:"//in.bmscdn.com/bmsin/m-combo/"+t+"_1.jpg",hoverImageURL:"//in.bmscdn.com/bmsin/m-combo/"+t+"_01.jpg",category:-1!==models.tShirtItemIds.indexOf(t)?models.itemCategory.tshirt:models.itemCategory.toy,variants:{},totalAvailableQuantity:0}),n[t].totalAvailableQuantity+=parseInt(e.AvailableQuantity),n[t].variants[e.ItemSeq]={tagLine:e.TagLine,sequence:e.ItemSeq,availableQuantity:10<=e.AvailableQuantity?10:e.AvailableQuantity}})),n},render.items=function(){for(var e=[],t=presenters.items(),n=0;n<5;n++){var o=$(BMS.Misc.Helpers.render(templates.item,{itemId:t[n].id,price:t[n].price,description:t[n].description,name:t[n].name,imageURL:t[n].imageURL,hoverImageURL:t[n].hoverImageURL}));dom.items[t[n].id]=o,e.push(o)}dom.itemsContainer.append(e),events.hover.bindItems(),BMS.Misc.fnBusy(!1,dom.itemsContainer),global.blnIsIE&&wow.init(),wow.scrolled=!0,wow.scrollHandler()},presenters.items=function(){var t=[];return _.each(models.items,(function(e){e.totalAvailableQuantity=e.totalAvailableQuantity/50*100,t.push(e)})),t.sort((function(e,t){return e.totalAvailableQuantity-t.totalAvailableQuantity})),t},events.hover={},events.click={},events.hover.bindItems=function(){$(".mrcitem").hover((function(){$(this).find("#marinfo").hide()}),(function(){$(this).find("#marinfo").show()}))},events.click.favouriteCinema=function(e){e.stopPropagation(),e.preventDefault(),$(this).hasClass("_favAdded")?fnFavRmv(strVenueCode):fnFavAdd(strVenueCode)},events.click.getApp=function(){var e=(new Date).getHours(),t={event:"Clickdownloadapp_Thankyou_2",session_daypart:0<=e&&e<12?"Morning":12<=e&&e<17?"Afternoon":17<=e&&e<21?"Evening":"Night",pagetype:"confirmation",pagesection:"Confirmation-web",domain:"bms_web",action:"click_downloadapp",user_mode:BMS.Storage.isset({name:"ld"})?"Logged In":"Guest Mode",app_code:"web"};BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},t),window.location=location.origin+"/mobile"},conf.fnInviteFriend=function(){try{if(!(1<conf.strQty))return void BMS.Misc.fnSCusErrDisplay("errDiv1","You've exceeded max no. of invitees","e");var e=$("#dInvite-friends").clone(!0);e.find("input[type='text'], input[type='tel']").val(""),$("#dIFriends-wrap").append(e),--conf.strQty}catch(e){BMS.Misc.fnErr({fnName:"conf.fnInviteFriend",err:e})}},conf.fnInitInviteModal=function(){try{for(var e=$("#dIFriends-wrap #dInvite-friends"),t=1;t<e.length;t++)$(e[t]).remove();conf.strQty=strQuantity,$("#errDiv1").hide(),BMS.Misc.modal("invite",!0)}catch(e){BMS.Misc.fnErr({fnName:"conf.fnInitInviteModal",err:e})}},conf.sendInviteMail=function(){try{var t,n=$("#customerName").val();t=$("#dIFriends-wrap #dInvite-friends");var o="";o="|";for(var i=0,s=0;s<t.length;s++){if($frdName=$(t[s]).find("input").eq(1),$frdNum=$(t[s]).find("input").eq(2),$frdMail=$(t[s]).find("input").eq(3),void 0,""===n||n==$frdName.attr("placeholder"))return void BMS.Misc.fnSCusErrDisplay("errDiv1","Please enter your name!","e");if(!BMS.Validate.chkName(n))return void BMS.Misc.fnSCusErrDisplay("errDiv1","Please enter a valid name!","e");if(o+="NAME="+n+"|",""===$frdName.val()||$frdName.val()==$frdName.attr("placeholder"))return void BMS.Misc.fnSCusErrDisplay("errDiv1","Please enter your friends name!","e");if(!BMS.Validate.chkName($frdName.val()))return void BMS.Misc.fnSCusErrDisplay("errDiv1","Please enter a valid name!","e");if(o+="NAME"+(i+1)+"="+$frdName.val(),""===$frdNum.val()||$frdNum.val()==$frdNum.attr("placeholder"))return void BMS.Misc.fnSCusErrDisplay("errDiv1","Please enter your friends mobile!","e");if(!BMS.Validate.mob($frdNum.val()))return void BMS.Misc.fnSCusErrDisplay("errDiv1","Please enter a valid mobile!","e");if(o+="|MOBILE"+(i+1)+"="+$frdNum.val()+"|",""!==$frdMail.val()){if(!BMS.Validate.email($frdMail.val()))return BMS.Misc.fnSCusErrDisplay("errDiv1","Please enter your friends valid email address!","e"),void $frdMail.focus();o+="MAIL"+(i+1)+"="+$frdMail.val()+"|"}i++}BMS.Misc.fnDoSecureTrans({transId:lngTransId,cmd:"INVITEGUESTS",venCode:"",p1:strBookingId,p2:o,fnCC:function(){$(".popover-event-name").html("Success"),$("#popover-rating-msg").html("Your friend(s) have been invited"),BMS.Misc.modal("review-rating-response",!0)},fnEC:function(t){BMS.Misc.fnErr({fnName:"conf.sendInviteMail",err:e})}})}catch(e){BMS.Misc.fnErr({fnName:conf.sendInviteMail,err:e})}},conf.fnResendConf=function(){try{BMS.Misc.fnBusy(!0,conf.ActionBusy),BMS.Misc.fnDoSecureTrans({cmd:1==blnisCODMoviesTransaction?"RESENDUNPAIDCONFIRMATION":"RESENDCONFIRMATIONMAIL",transId:lngTransId,p1:strBookingId,p2:strMemberEmail,p3:strMemberMobile,p10:0==blnisCODMoviesTransaction&&1==blnIsCod?"|TYPE=COD|":"",blnSupp:!1,fnCC:function(){BMS.Misc.fnBusy(!1,conf.ActionBusy),$(".popover-event-name").html("Success"),$("#popover-rating-msg").html("Confirmation sent successfully"),BMS.Misc.modal("review-rating-response",!0)},fnEC:function(){BMS.Misc.fnBusy(!1,conf.ActionBusy)}})}catch(e){BMS.Misc.fnErr({fnName:"conf.fnResendConf",err:e})}},conf.showOrderSummary=function(){var e=$(".total .__text"),t=$(".__summary");"block"==t.css("display")?(t.slideUp(),e.find(".icon-minus").css("display","none"),e.find(".icon-plus").css("display","inline-block")):(t.slideDown(),e.find(".icon-minus").css("display","inline-block"),e.find(".icon-plus").css("display","none"))},conf.openAmexCallout=function(){try{BMS.Misc.modal("amexCallout",!0),global.blnIsTouchScreen&&($("body").addClass("_fixed"),setTimeout((function(){$("#amexCallout","body").css({top:"0px"}),$("#amexCallout .body").css({height:window.innerHeight-20})}),2e3))}catch(e){BMS.Misc.fnErr({fnName:"conf.openAmexCallout",fnParams:arguments,err:e})}},conf.validateAmexFields=function(){try{$("#amexErrorMsg").html("").hide();var e=$("#amexTxtFirstname"),t=$("#amexTxtLastname"),n=$("#amexTxtEmail"),o=$("#amexTxtMobile"),i=$("#amexTxtPancard"),s=$("#amexMonthlyIncome"),r=$("#amexTxtState"),a=$("#amexTxtCities"),c=$("#amexTxtAddress"),d=$("#amexTxtPin"),l=($("#amexRdbMale"),$("#amexDD")),f=$("#amexMM"),p=$("#amexYY"),u=$("#amexDisclaimer");if(!BMS.Validate.chkName(e.val()))return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please enter the correct first name!","e"),e.focus(),!1;if(!BMS.Validate.chkName(t.val()))return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please enter the correct last name!","e"),t.focus(),!1;if(!BMS.Validate.email(n.val()))return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please enter the correct email id!","e"),n.focus(),!1;if(!BMS.Validate.mob(o.val()))return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please enter the correct mobile number!","e"),o.focus(),!1;if(!BMS.Validate.rblpancard(i.val()))return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please enter the correct pan card number!","e"),i.focus(),!1;if(""==s.val()||null==s.val())return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please enter correct monthly income!","e"),s.focus(),!1;if(""==r.val()||null==r.val())return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please select a state!","e"),r.focus(),!1;if(""==a.val()||null==a.val())return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please select a city!","e"),a.focus(),!1;if(""==c.val()||null==c.val())return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please enter correct address!","e"),c.focus(),!1;if(!BMS.Validate.pincode(d.val()))return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please enter the correct pincode!","e"),d.focus(),!1;if(0==$("#amexRdbMale").is(":checked")&&0==$("#amexRdbFemale").is(":checked")&&0==$("#amexRdbOther").is(":checked"))return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please select the gender!","e"),!1;if(""==l.val()||0==l.val()||l.val()<=0||31<l.val())return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please enter the correct day!","e"),l.focus(),!1;if(""==f.val()||0==f.val()||f.val()<=0||12<f.val())return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please enter the correct month!","e"),f.focus(),!1;if(""==p.val()||p.val()>=(new Date).getFullYear()||p.val()<=(new Date).getFullYear()-150)return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please enter the correct year!","e"),p.focus(),!1;if(!u.is(":checked"))return BMS.Misc.fnSCusErrDisplay("amexErrorMsg","Please select I agree!","e"),u.focus(),!1;conf.makeAmexRequest()}catch(e){BMS.Misc.fnErr({fnName:"conf.validateAmexFields",fnParams:arguments,err:e})}},conf.makeAmexRequest=function(){try{$("#amexErrorMsg").hide(),BMS.Misc.modal("amexCallout",!1),setTimeout((function(){BMS.Misc.modal("rblProgressScreen",!0)}),500);var e=$("#amexTxtFirstname").val(),t=$("#amexTxtLastname").val(),n=$("#amexTxtEmail").val().toLowerCase(),o=$("#amexTxtMobile").val(),i=$("#amexMonthlyIncome").val(),s=$("#amexTxtPancard").val().toUpperCase(),r=global.strAppCode,a=$("#amexTxtAddress").val(),c=$("#amexTxtCities :selected").val(),d=$("#amexTxtState :selected").val(),l=$("#amexTxtPin").val(),f=null;$("#amexRdbMale").is(":checked")?f=1:$("#amexRdbFemale").is(":checked")?f=2:$("#amexRdbOther").is(":checked")&&(f=0);$("#amexDisclaimer").val();var p=$("#amexDD").val()+"-"+$("#amexMM").val()+"-"+$("#amexYY").val();BMS.Misc.fnAjax({type:"POST",data:{cmd:"SAVE",data:JSON.stringify({firstName:e,lastName:t,chosenCard:"membershipreward",email:n,mobile:o,monthlyIncome:i,panCardNo:s,type:"AMEXCARD",appCode:r,details:{address:a,city:c,state:d,pin:l,gender:f,dob:p}})},dataType:"json",success:function(e){var t=null!=e.data.statusCode&&""!=e.data.statusCode?e.data.statusCode:"";if(void 0!==t)switch(t){case 0:BMS.Misc.modal("amexProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("amexApprovalScreen",!0),$("._rbl-progress-screens #amexNotApproved").show(),$("._rbl-progress-screens #amexAlreadyRegistered").hide(),$("._rbl-progress-screens #amexPending").hide(),$("._rbl-progress-screens #amexApproved").hide(),$("._rbl-progress-screens #amexError").hide()}),500);break;case 1:BMS.Misc.modal("amexProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("amexApprovalScreen",!0),$("._rbl-progress-screens #amexNotApproved").hide(),$("._rbl-progress-screens #amexAlreadyRegistered").hide(),$("._rbl-progress-screens #amexPending").hide(),$("._rbl-progress-screens #amexApproved").show(),$("._rbl-progress-screens #amexError").hide()}),500);break;case 2:BMS.Misc.modal("amexProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("amexApprovalScreen",!0),$("._rbl-progress-screens #amexNotApproved").hide(),$("._rbl-progress-screens #amexAlreadyRegistered").hide(),$("._rbl-progress-screens #amexPending").show(),$("._rbl-progress-screens #amexApproved").hide(),$("._rbl-progress-screens #amexError").hide()}),500);break;default:BMS.Misc.modal("amexProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("amexApprovalScreen",!0),$("._rbl-progress-screens #amexNotApproved").show(),$("._rbl-progress-screens #amexAlreadyRegistered").hide(),$("._rbl-progress-screens #amexPending").hide(),$("._rbl-progress-screens #amexApproved").hide(),$("._rbl-progress-screens #amexError").hide()}),500)}else BMS.Misc.modal("amexProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("amexApprovalScreen",!0),$("._rbl-progress-screens #amexNotApproved").hide(),$("._rbl-progress-screens #amexAlreadyRegistered").hide(),$("._rbl-progress-screens #amexPending").hide(),$("._rbl-progress-screens #amexApproved").hide(),$("._rbl-progress-screens #amexError").show()}),500)},error:function(e){BMS.Misc.modal("amexProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("amexApprovalScreen",!0),$("._rbl-progress-screens .rblNotApproved").hide(),$("._rbl-progress-screens .rblAlreadyRegistered").hide(),$("._rbl-progress-screens .rblPending").hide(),$("._rbl-progress-screens .rblApproved").hide(),$("._rbl-progress-screens .rblError").show()}),500)},url:"/serv/getData.bms?cmd=SAVEAMEXFIELDS"})}catch(e){BMS.Misc.fnErr({fnName:"conf.validateAmexFields",fnParams:arguments,err:e})}},$(document).ready((function(){$("#openRblCallout").click(conf.openRblCallout),$("#rblDismiss").click(conf.closeRblCallout),$("#rblFieldsValidate").click(conf.validateRblFields),$("#rblDD, #rblMM, #rblYY, #txtPin").keypress((function(e){if(8!=e.which&&0!=e.which&&(e.which<48||57<e.which))return!1})),$("#openAmexCallout").click(conf.openAmexCallout),$("#amexDismiss").click(conf.closeAmexCallout),$("#amexFieldsValidate").click(conf.validateAmexFields),$("#amexDD, #amexMM, #amexYY, #amexTxtPin").keypress((function(e){if(8!=e.which&&0!=e.which&&(e.which<48||57<e.which))return!1}));var o={"Andhra Pradesh":["Hyderabad"],Delhi:["Delhi","Faridabad"],Gujarat:["Ahmedabad","Surat","Vadodra"],Haryana:["Gurgaon"],Karnataka:["Bangalore"],"Madhya Pradesh":["Indore"],Maharashtra:["Mumbai","Navi Mumbai","Pune","Thane"],Punjab:["Chandigarh"],Rajasthan:["Jaipur"],"Tamil Nadu":["Chennai","Coimbatore"],"Uttar Pradesh":["Greater Noida","Noida"],"West Bengal":["Kolkata"]};$("#amexTxtState").on("change",(function(e){var t=$(this).val();if($("#amexTxtCities").children("option:not(:first)").remove(),$("#amexTxtCities").children("option:first").prop("selected",!0),"Others"!=t){var n=o[t];$.each(n,(function(e,t){var n='<option value="'+t+'">'+t+"</option>";$("#amexTxtCities").append(n)}))}$("#amexTxtCities").append('<option value="Others">Others</option>')})),$(".txtServiceTaxShowHide").click((function(){var e=$(this).children().closest(".__show"),t=$(this).children().closest(".__hide"),n=$(".__breakdown");"block"==e.css("display")?(t.show(),e.hide(),n.show()):(e.show(),t.hide(),n.hide())})),0<window.navigator.userAgent.indexOf("MSIE ")&&$("input[placeholder], textarea[placeholder]").each((function(e,t){$(t).setAltText({text:$(t).attr("placeholder")})})),conf.fnPgLd(),-1!=BMS.Storage.get({name:"userCine",key:"fav"}).indexOf(strVenueCode)?$(".tickets .details .ticket-info .heart-icon").addClass("_favAdded").attr("data-title","Remove from Favourites"):BMS.Storage.isset({name:"ld"})&&fnFavAdd(strVenueCode),$(".tickets .details .ticket-info .heart-icon").on("tap.hearticon",events.click.favouriteCinema),$(".music-container .get-app").on("click",events.click.getApp),conf.firePurchaseCompletedEvent(),0<$(".reward-touch-container").length&&$(".footer").css({"padding-bottom":"100px"}),0<$(".reward-container").length&&$(".details").addClass("reward-program"),window.matchMedia("(min-width: 320px) and (max-width: 500px)").matches&&setTimeout((function(){var e=$("#ad-info-pop-up");e&&"block"===e[0].style.display?$(".modal-dismiss-button-container").click((function(){initiateRewardPopup()})):initiateRewardPopup()}),1e3)})),conf.fnUnpaidCancelConf=function(){try{BMS.Misc.modal("unpaidCancelConfPopup",!0)}catch(e){BMS.Misc.fnErr({fnName:"conf.fnUnpaidCancelConf",fnParams:arguments,err:e})}},conf.fnPayUnpaidTrans=function(){try{BMS.Misc.fnBusy(!0),BMS.Misc.fnDoTrans({AppC:global.strAppCode,venCode:strVenueCode,transId:lngTransId,cmd:"LOADUNPAIDBOOKING",fnCC:function(e){BMS.Storage.del({name:"pay_"+lngTransId,storage:"C"}),BMS.Storage.set({name:"lngTransId",value:lngTransId,storage:"C"}),BMS.Storage.set({name:"BOOKINGID",value:strBookingId,storage:"C"}),BMS.Misc.fnPushEventDataToAnalytics(["WR","KM","WN"],"Pay Reserved Seat",{ProductID:"","Event Name":strEventName,"Event Type":"MT","Venue Name":strVenueName,Language:"","Seat Info":"",Source:"Confirmation",Genre:"",Appcode:global.strAppCode}),BMS.Misc.fnGoTo("https://"+location.host+"/payment/?cid="+strVenueCode+"&sid="+lngSessionId+"&ety="+strEventType)},fnEC:function(e){}})}catch(e){BMS.Misc.fnErr({fnName:"conf.fnPayUnpaidTrans",fnParams:arguments,err:e})}},conf.fnCancelUnpaidTrans=function(){try{BMS.Misc.fnBusy(!0),BMS.Misc.modal("unpaidCancelConfPopup",!1),BMS.Misc.fnDoTrans({AppC:global.strAppCode,transId:lngTransId,cmd:"CANCELUNPAIDBOOK",venCode:strVenueCode,p1:lngBookingId,fnCC:function(e){BMS.Misc.fnBusy(!1),$("#spnRedUnpaidTag").html("Cancelled"),$("[data-id='actions-div'] a").removeAttr("onclick"),$("[data-id='actions-div'] a").removeAttr("href"),$("[data-id='actions-div'] a").addClass("_disabled"),BMS.Misc.modal("unpaidCancelReasonPopup",!0)},fnEC:function(e){}})}catch(e){BMS.Misc.fnErr({fnName:"conf.fnCancelUnpaidTrans",err:e})}},conf.fnCaptureUnpaidCancelReason=function(){try{if($("#errDivUnpaidCancelReason").hide(),0==$("input[type='radio'][name='rdbCancelReason']:checked").length)return void BMS.Misc.fnSCusErrDisplay("errDivUnpaidCancelReason","Please choose an option","e");BMS.Misc.fnPushEventDataToAnalytics(["WR","KM"],"Cancel Reserve Booking",{ProductID:strEventCode,"Event Name":strEventName,"Event Type":strEventType,"Venue Name":strVenueName,"Venue Group":strVenueName,Source:"Confirmation","Cancel Reason":$("input[type='radio'][name='rdbCancelReason']:checked").attr("data-value"),Appcode:global.strAppCode}),BMS.Misc.modal("unpaidCancelReasonPopup",!1)}catch(e){BMS.Misc.fnErr({fnName:"conf.fnCaptureUnpaidCancelReason",err:e})}var e=window.location.origin+"/movies";window.location=e},conf.fnCaptureUnpaidCancelReasonSkip=function(){BMS.Misc.modal("unpaidCancelReasonPopup",!1);var e=window.location.origin+"/movies";window.location=e},conf.openRblCallout=function(){try{BMS.Misc.modal("rblCallout",!0),conf.generateCities(),$("#rblForm")[0].reset(),$("form#rblForm #txtEmail").val(strMemberEmail),$("form#rblForm #txtMobile").val(strMemberMobile),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"RBL offer",{"Apply now Page":"Confirmation Page","Form Submit":"No",Status:"OpenForm",Appcode:global.strAppCode})}catch(e){BMS.Misc.fnErr({fnName:"conf.openRblCallout",fnParams:arguments,err:e})}},conf.generateCities=function(){try{var e=[{name:"Gurgaon",code:"7",valCodeMin:"12",valCodeMax:"13"},{name:"Hyderabad",code:"15",valCodeMin:"50",valCodeMax:"56"},{name:"Bengaluru",code:"19",valCodeMin:"53",valCodeMax:"59"},{name:"Chennai",code:"21",valCodeMin:"53",valCodeMax:"66"},{name:"Ahmedabad",code:"22",valCodeMin:"36",valCodeMax:"39"},{name:"Mumbai",code:"25",valCodeMin:"40",valCodeMax:"44"},{name:"Pune",code:"26",valCodeMin:"40",valCodeMax:"44"},{name:"Kolkata",code:"64",valCodeMin:"70",valCodeMax:"74"},{name:"Noida",code:"78",valCodeMin:"20",valCodeMax:"28"},{name:"Ghaziabad",code:"87",valCodeMin:"20",valCodeMax:"28"},{name:"Indore",code:"106",valCodeMin:"45",valCodeMax:"48"},{name:"Navi Mumbai",code:"163",valCodeMin:"40",valCodeMax:"44"},{name:"Surat",code:"190",valCodeMin:"36",valCodeMax:"39"},{name:"New Delhi",code:"318",valCodeMin:"11",valCodeMax:"11"},{name:"Thane",code:"640",valCodeMin:"40",valCodeMax:"44"},{name:"Greater Noida",code:"704",valCodeMin:"20",valCodeMax:"28"},{name:"Baroda",code:"707",valCodeMin:"36",valCodeMax:"39"},{name:"Lucknow",code:"807",valCodeMin:"20",valCodeMax:"28"},{name:"Ahmednagar",code:"979",valCodeMin:"40",valCodeMax:"44"},{name:"Belgaum",code:"980",valCodeMin:"53",valCodeMax:"59"},{name:"Faridabad",code:"981",valCodeMin:"12",valCodeMax:"13"},{name:"Kolhapur",code:"983",valCodeMin:"40",valCodeMax:"44"},{name:"Mangalore",code:"984",valCodeMin:"53",valCodeMax:"59"},{name:"Salem",code:"989",valCodeMin:"53",valCodeMax:"66"},{name:"Sangli",code:"990",valCodeMin:"40",valCodeMax:"44"},{name:"Udaipur",code:"992",valCodeMin:"30",valCodeMax:"34"},{name:"Vadodara",code:"993",valCodeMin:"36",valCodeMax:"39"},{name:"Hubli",code:"1011",valCodeMin:"53",valCodeMax:"59"},{name:"Howrah",code:"1034",valCodeMin:"70",valCodeMax:"74"},{name:"Jaipur",code:"100",valCodeMin:"0",valCodeMax:"0"},{name:"Chandigarh",code:"9",valCodeMin:"0",valCodeMax:"0"},{name:"Panchkula",code:"2223",valCodeMin:"0",valCodeMax:"0"},{name:"Mohali",code:"1087",valCodeMin:"0",valCodeMax:"0"}],t='<option value="">Select City</option>';for(i=0;i<e.length;i++)t+='<option value="'+e[i].name+'" data-code="'+e[i].code+'" data-pin-min="'+e[i].valCodeMin+'" data-pin-max="'+e[i].valCodeMax+'">'+e[i].name+"</option>";$("#txtCity").append(t)}catch(e){BMS.Misc.fnErr({fnName:"conf.generateCities",fnParams:arguments,err:e})}},conf.validateRblFields=function(){try{var e=$("#txtFirstname"),t=$("#txtLastname"),n=$("#txtEmail"),o=$("#txtMobile"),i=$("#txtCity"),s=$("#txtPancard"),r=$("#txtAddress-1").val(),a=$("#txtAddress-2").val(),c=$("#txtPin"),d=$("#rdbMale"),l=($("#rdbFemale"),$("#rblDD")),f=$("#rblMM"),p=$("#rblYY"),u=$("#txtCity").find(":selected").attr("data-pin-min"),m=$("#txtCity").find(":selected").attr("data-pin-max");if(!BMS.Validate.chkName(e.val()))return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please enter the correct first name!","e"),e.focus(),!1;if(!BMS.Validate.chkName(t.val()))return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please enter the correct last name!","e"),t.focus(),!1;if(!BMS.Validate.email(n.val()))return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please enter the correct email id!","e"),n.focus(),!1;if(!BMS.Validate.mob(o.val()))return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please enter the correct mobile number!","e"),o.focus(),!1;if(""==i.val())return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please select the correct city!","e"),i.focus(),!1;if(!BMS.Validate.rblpancard(s.val()))return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please enter the correct pan card number!","e"),s.focus(),!1;if(!BMS.Validate.address(r.val().trim()))return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please enter the correct address!","e"),txtAddress.focus(),!1;if(!BMS.Validate.address(a.val().trim()))return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please enter the correct address!","e"),txtAddress.focus(),!1;if(!BMS.Validate.pincode(c.val()))return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please enter the correct pincode!","e"),c.focus(),!1;var M=c.val().substring(2,0);if(0!=u){if(!(M<=m&&u<=M))return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please select the city closest to your pincode.","e"),c.focus(),!1}else{var h=$("#txtCity").find(":selected").data("code");if(-1==$.inArray(c.val(),{100:["202016","301012","302001","302002","302003","302004","302005","302006","302007","302008","302009","302010","302011","302012","302013","302014","302015","302016","302017","302018","302019","302020","302021","302022","302023","302024","302025","302026","302027","302028","302029","302030","302031","302032","302033","302034","302035","302036","302037","302039","302040","302041","302047","302121","302203","302424","302601","302620","302833","302906","303001","303002","303003","303005","303006","303007","303008","303009","303010","303012","303013","303015","303017","303019","303029","303032","303036","303101","303102","303103","303104","303105","303106","303107","303108","303109","303110","303119","303120","303121","303122","303301","303302","303306","303307","303314","303328","303329","303330","303331","303338","303339","303348","303601","303602","303603","303604","303609","303701","303702","303704","303706","303712","303801","303802","303803","303804","303805","303806","303807","303810","303901","303902","303903","303904","303905","303906","303907","303908","304002","321105","322016","330017","362014"],9:["140119","140125","140133","140301","160001","160002","160003","160004","160008","160009","160010","160011","160012","160014","160015","160016","160017","160018","160019","160020","160022","160023","160024","160025","160026","160028","160030","160031","160035","160036","160037","160038","160040","160042","160043","160044","160045","160046","160047","160048","160049","160051","160053","160061","160063","160100","160101","160102","160106","160109","160118","160603","160604"],2223:["133302","134001","134101","134102","134103","134104","134107","134108","134109","134111","134112","134113","134114","134115","134116","134117","134118","134119","134209","134417"],1087:["140070","140103","140104","140106","140109","140110","140306","140307","140308","140413","140604","140901","147506","152126","160033","160034","160052","160054","160055","160056","160057","160058","160059","160062","160064","160065","160066","160067","160068","160069","160070","160071","160103"]}[h]))return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please select the city closest to your pincode.","e"),c.focus(),!1}if(0==$("#rdbMale").is(":checked")&&0==$("#rdbFemale").is(":checked"))return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please enter the gender!","e"),d.focus(),!1;if(""==l.val()||0==l.val()||l.val()<=0||31<l.val())return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please enter the correct day!","e"),l.focus(),!1;if(""==f.val()||0==f.val()||f.val()<=0||12<f.val())return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please enter the correct month!","e"),f.focus(),!1;if(""==p.val()||p.val()<=1900||1998<p.val())return BMS.Misc.fnSCusErrDisplay("rblErrorMsg","Please enter the correct year!","e"),p.focus(),!1;conf.chKNewRblUser()}catch(e){BMS.Misc.fnErr({fnName:"conf.validateRblFields",fnParams:arguments,err:e})}},conf.chKNewRblUser=function(){try{BMS.Misc.fnPushEventDataToAnalytics(["WR"],"RBL offer",{"Apply now Page":"Confirmation Page","Form Submit":"Yes",Status:"Submitted",Appcode:global.strAppCode}),$("#rblErrorMsg").hide(),BMS.Misc.modal("rblCallout",!1),setTimeout((function(){BMS.Misc.modal("rblProgressScreen",!0)}),500);$("#rdbMale").is(":checked");var e=$("#txtEmail").val().toLowerCase(),t=$("#txtMobile").val(),n=$("#txtPancard").val();BMS.Misc.fnAjax({type:"POST",data:{email:e,mobile:t,panCardNo:n,type:"RBLBANK"},dataType:"json",success:function(e){void 0,"N"==e.data.exists?conf.saveNewRblUser():(BMS.Misc.modal("rblProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("rblApprovalScreen",!0),$("._rbl-progress-screens .rblNotApproved").hide(),$("._rbl-progress-screens .rblAlreadyRegistered").show(),$("._rbl-progress-screens .rblPending").hide(),$("._rbl-progress-screens .rblApproved").hide(),$("._rbl-progress-screens .rblError").hide()}),500),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"RBL offer",{"Apply now Page":"Confirmation Page","Form Submit":"Yes",Status:"Already registered",Appcode:global.strAppCode}))},error:function(e){BMS.Misc.modal("rblProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("rblApprovalScreen",!0),$("._rbl-progress-screens .rblNotApproved").hide(),$("._rbl-progress-screens .rblAlreadyRegistered").hide(),$("._rbl-progress-screens .rblPending").hide(),$("._rbl-progress-screens .rblApproved").hide(),$("._rbl-progress-screens .rblError").show()}),500),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"RBL offer",{"Apply now Page":"Confirmation Page","Form Submit":"Yes",Status:"Error",Appcode:global.strAppCode})},url:"/serv/getData?cmd=CHECKRBLFIELDS"})}catch(e){BMS.Misc.fnErr({fnName:"conf.chKNewRblUser",fnParams:arguments,err:e})}},conf.saveNewRblUser=function(){try{var e=$("#txtFirstname").val(),t=$("#txtLastname").val(),n=$("#txtEmail").val().toLowerCase(),o=$("#txtMobile").val(),i=$("#txtPancard").val(),s=global.strAppCode,r=$("#txtAddress-1").val(),a=$("#txtAddress-2").val(),c=$("#txtCity :selected").attr("data-code"),d=$("#rblDD").val()+"-"+$("#rblMM").val()+"-"+$("#rblYY").val(),l=$("#rdbMale").is(":checked")?1:2,f=$("#txtPin").val();BMS.Misc.fnAjax({type:"POST",data:{fname:e,lname:t,email:n,mobile:o,panCardNo:i,type:"RBLBANK",appCode:s,address1:r,address2:a,city:c,dob:d,gender:l,pin:f,strSource:"CONFIRMATIONPAGE",otp:"",token:"",params:{param1:"",param2:"",param3:"",param4:"",param5:""}},dataType:"json",success:function(e){var t=null!=e.data.statusCode&&""!=e.data.statusCode?e.data.statusCode:"";if(void 0!==t)switch(t){case 0:BMS.Misc.modal("rblProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("rblApprovalScreen",!0),$("._rbl-progress-screens .rblNotApproved").show(),$("._rbl-progress-screens .rblAlreadyRegistered").hide(),$("._rbl-progress-screens .rblPending").hide(),$("._rbl-progress-screens .rblApproved").hide(),$("._rbl-progress-screens .rblError").hide()}),500),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"RBL offer",{"Apply now Page":"Confirmation Page","Form Submit":"Yes",Status:"Not Approved",Appcode:global.strAppCode});break;case 1:BMS.Misc.modal("rblProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("rblApprovalScreen",!0),$("._rbl-progress-screens .rblNotApproved").hide(),$("._rbl-progress-screens .rblAlreadyRegistered").hide(),$("._rbl-progress-screens .rblPending").hide(),$("._rbl-progress-screens .rblApproved").show(),$("._rbl-progress-screens .rblError").hide()}),500),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"RBL offer",{"Apply now Page":"Confirmation Page","Form Submit":"Yes",Status:"Approved",Appcode:global.strAppCode});break;case 2:BMS.Misc.modal("rblProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("rblApprovalScreen",!0),$("._rbl-progress-screens .rblNotApproved").hide(),$("._rbl-progress-screens .rblAlreadyRegistered").hide(),$("._rbl-progress-screens .rblPending").show(),$("._rbl-progress-screens .rblApproved").hide(),$("._rbl-progress-screens .rblError").hide()}),500),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"RBL offer",{"Apply now Page":"Confirmation Page","Form Submit":"Yes",Status:"Pending",Appcode:global.strAppCode});break;default:BMS.Misc.modal("rblProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("rblApprovalScreen",!0),$("._rbl-progress-screens .rblNotApproved").show(),$("._rbl-progress-screens .rblAlreadyRegistered").hide(),$("._rbl-progress-screens .rblPending").hide(),$("._rbl-progress-screens .rblApproved").hide(),$("._rbl-progress-screens .rblError").hide()}),500),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"RBL offer",{"Apply now Page":"Confirmation Page","Form Submit":"Yes",Status:"Not approved",Appcode:global.strAppCode})}else BMS.Misc.modal("rblProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("rblApprovalScreen",!0),$("._rbl-progress-screens .rblNotApproved").hide(),$("._rbl-progress-screens .rblAlreadyRegistered").hide(),$("._rbl-progress-screens .rblPending").hide(),$("._rbl-progress-screens .rblApproved").hide(),$("._rbl-progress-screens .rblError").show()}),500),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"RBL offer",{"Apply now Page":"Confirmation Page","Form Submit":"Yes",Status:"Error",Appcode:global.strAppCode})},error:function(e){BMS.Misc.modal("rblProgressScreen",!1),setTimeout((function(){BMS.Misc.modal("rblApprovalScreen",!0),$("._rbl-progress-screens .rblNotApproved").hide(),$("._rbl-progress-screens .rblAlreadyRegistered").hide(),$("._rbl-progress-screens .rblPending").hide(),$("._rbl-progress-screens .rblApproved").hide(),$("._rbl-progress-screens .rblError").show()}),500),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"RBL offer",{"Apply now Page":"Confirmation Page","Form Submit":"Yes",Status:"Error",Appcode:global.strAppCode})},url:"/serv/getData?cmd=SAVERBLFIELDS"})}catch(e){BMS.Misc.fnErr({fnName:"conf.saveNewRblUser ",fnParams:arguments,err:e})}};var afterSignIn=!(conf.closeRblCallout=function(e){try{e.preventDefault(),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"RBL offer",{"Apply now Page":"Confirmation Page","Form Submit":"No",Status:"",Appcode:global.strAppCode}),BMS.Misc.modal("rblCallout",!1)}catch(e){BMS.Misc.fnErr({fnName:"conf.closeRblCallout ",fnParams:arguments,err:e})}});function fnFavAdd(t){afterSignIn||(afterSignIn=!1);try{if(BMS.Storage.isset({name:"ld"})){var e=BMS.Storage,n=(e.get({name:"ld"}),e.get({name:"ld",key:"MEMBEREMAIL"}),e.get({name:"ld",key:"LSID"})),o=e.get({name:"ld",key:"MEMBERID",defVal:""});BMS.Misc.fnDoSecureTrans({venCode:t,cmd:"SETPROFILE",p1:"SETFAVORITE",p2:o,p3:n,p4:t,fnCC:fnFavSuc,fnEC:fnFavFail,blnSupp:!0}),$(".tickets .details .ticket-info .heart-icon").addClass("_favAdded").attr("data-title","Remove from Favourites")}else $("#signinPopup .body .body-wrapper .section-head").html('<h2>Signin to add this cinema to <span class="jenna-sue">your favourites</span></h2>'),BMS.SignIn.fnSignIn(!0),null==global.SignInCallBack&&(global.SignInCallBack=[]),BMS.SignIn.fnRegister("confirmation-fav",(function(){afterSignIn=!0,fnFavAdd(t),conf.fnGetMemberHistory("I")}))}catch(e){BMS.Misc.fnErr({fnName:"fnFavAdd",fnParams:t,err:e})}}function fnFavFail(t){try{void 0}catch(e){BMS.Misc.fnErr({fnName:"fnFavFail",fnParams:t,err:e})}}function fnFavRmv(t){try{if(BMS.Storage.isset({name:"ld"})){var e=BMS.Storage,n=(e.get({name:"ld"}),e.get({name:"ld",key:"MEMBEREMAIL"}),e.get({name:"ld",key:"LSID"})),o=e.get({name:"ld",key:"MEMBERID"});BMS.Misc.fnDoSecureTrans({venCode:t,cmd:"SETPROFILE",p1:"REMOVEFAVORITE",p2:o,p3:n,p4:t,fnCC:fnFavSuc,fnEC:fnFavFail,blnSupp:!0}),$(".tickets .details .ticket-info .heart-icon").removeClass("_favAdded").attr("data-title","Mark as Favourite")}else BMS.SignIn.fnSignIn(!0),$("#signinPopup .body .body-wrapper .section-head").html('<h2>Signin to remove this cinema from <span class="jenna-sue">your favourites</span></h2>'),null==global.SignInCallBack&&(global.SignInCallBack=[]),BMS.SignIn.fnRegister("confirmation-fav",(function(){afterSignIn=!0,fnFavRmv(t)}))}catch(e){BMS.Misc.fnErr({fnName:"fnFavRmv",fnParams:t,err:e})}}function fnFavSuc(t){try{var e=unescape(t),n=BMS.Misc.fnGVal({key:"FAV",data:e});BMS.Storage.set({name:"userCine",key:"fav",value:n,storage:"C",sess:!1}),afterSignIn&&(afterSignIn=!1)}catch(e){BMS.Misc.fnSCusErrDisplay({fnName:"fnFavSuc",fnParams:t,err:e})}}function showWhatsAppOptIn(){try{var e=whatsAppDetails||{};e.isFirstTimeWhatsappUser&&"true"===e.isFirstTimeWhatsappUser.toLowerCase()&&(conf.timeOut=e.PopUpDelay||conf.timeOut,conf.popUpImage=e.PopUpImage||"",conf.popUpText=e.PopUpText||"",setTimeout((function(){conf.whatsAppOptIn()}),conf.timeOut))}catch(e){BMS.Misc.fnErr({fnName:"showWhatsAppOptIn",err:e})}}conf.fnPrebookResendConf=function(){try{BMS.Misc.fnBusy(!0),BMS.Misc.fnDoTrans({cmd:"SENDPREBOOKCONFIRMATIONMAIL",p1:lngPreBookId.replace("PB-",""),p2:intSequence,fnCC:function(){BMS.Misc.fnBusy(!1),$(".popover-event-name").html("Success"),$("#popover-rating-msg").html("Confirmation sent successfully"),BMS.Misc.modal("review-rating-response",!0)},fnEC:function(){BMS.Misc.fnBusy(!1)}})}catch(e){BMS.Misc.fnErr({fnName:"conf.fnPrebookResendConf",err:e})}},conf.fnPrebookCancelConf=function(){try{confirm("Are you sure you want to cancel this prebook transaction?")&&(BMS.Misc.fnBusy(!0),BMS.Misc.fnDoTrans({cmd:"CANCELPREBOOKEX",p1:lngPreBookId.replace("PB-",""),p2:intSequence,p3:BMS.Storage.get({name:"ld",key:"MEMBEREMAIL",storage:"C"}),fnCC:function(){BMS.Misc.fnBusy(!1),$("#spnRedUnpaidTag").html("Cancelled"),$(".popover-event-name").html("Success"),$("#popover-rating-msg").html("Transaction Cancelled!"),BMS.Misc.modal("review-rating-response",!0)},fnEC:function(){BMS.Misc.fnBusy(!1)}}))}catch(e){BMS.Misc.fnErr({fnName:"conf.fnPrebookCancelConf",err:e})}},conf.fnOpenFnbListingPage=function(e,t,n){try{var o=$("#frmOrderFnb");$(o).attr("action","/fnb-listing?vc="+n+"&enc=1"),o.find("[name='lngTransId']").val(e),o.find("[name='BOOKINGID']").val(t),BMS.Misc.fnBusy(!0),o.submit()}catch(e){BMS.Misc.fnErr({fnName:"profile.fnOpenFnbListingPage",err:e})}},conf.fnOpenFnbListingPageMweb=function(e){try{var t=btoa(e),n=JSON.parse(e);$("#frmOrderFnb");BMS.Misc.fnBusy(!0),location.href="/food-beverages-combos/"+n.venueCode+"?q="+t}catch(e){BMS.Misc.fnErr({fnName:"profile.fnOpenFnbListingPageMweb",err:e})}},conf.fnGetCouponListing=function(e){try{$("#addCouponsListTemplate").html(""),BMS.Misc.fnBusy(!0),addCouponsHtml="",objCpnData={},objProcCpnData={},cpnSetIds=[],cpnReqId=[],$("#cpnStrEvtName").text(strEventName),$("#cpnStrVenName").text(strVenueName),$("#cpnStrLan").text(strLanguage),$("#cpnStrDim").text(strEventDimension),$("#cpnStrDate").text(strCpnShowDate);var t=strShowTime,n=Number(t.match(/^(\d+)/)[1]),o=Number(t.match(/:(\d+)/)[1]),i=t.match(/(.*)$/)[0].slice(-2);("PM"==i||"pm"==i)&&n<12&&(n+=12),"AM"!=i&&"am"!=i||12!=n||(n-=12);var s=n.toString(),r=o.toString();n<10&&(s="0"+s),o<10&&(r="0"+r);var a=s+r;void 0;var c=strTicketsTotal.slice(0,-5);cpnShowDate=strShowDate.slice(0,-4);var d="MT"===strEventType?"confirmation":"confirmationevent";BMS.Misc.fnAjax({url:"/serv/getData",type:"GET",dataType:"json",data:{cmd:"GETCOUPONSEATNEW",vid:strVenueCode,Appc:global.strAppCode,eid:strEventCode,st:a,tq:strQuantity,tp:c,dc:cpnShowDate,TxnType:d,RecoEmail:BMS.Storage.get({name:"le"}),UserRgn:BMS.Region.fnGRgn()},success:function(e){BMS.Misc.fnBusy(!1),conf.fnDisCpnListing(e)},error:function(e){BMS.Misc.fnBusy(!1)}}),BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},{event:"userselectscoupons_Coupon_listing_page_3",action:"GetCouponsButtonClick",label:""})}catch(e){void 0}},conf.fnDisCpnListing=function(n){try{cpnPgNext=n.page.next,cpnPgPrev=n.page.prev,cpnReqId.push(n.reqId),("undefined"!=n||0<n.length)&&($("#add-coupon-layout").show(),$("body").addClass("_fixed"),0<(couponObjectData=n).couponsets.length?($("#addCouponsListTemplate h3").remove(),addCouponsHtml="",_.each(n.couponsets,(function(e,t){couponBought=e.isNewCampaign?" New":e.boughtCount+" Bought",35<e.offerDescription.length?coupondescription=e.offerDescription.substr(0,35)+"...":coupondescription=e.offerDescription,e.inCinema?couponLocation="In Cinema":e.inMall?couponLocation="In Mall":(1<e.distanceFromCinema?DisCinema=e.distanceFromCinema+" KM":DisCinema=1e3*e.distanceFromCinema+" m",couponLocation=DisCinema),void 0,addCouponsHtml+=BMS.Misc.Helpers.render($("#add-coupon-list-template").html(),{couponId:conf.couponDetailsData.length+t,couponImage:e.brandLogo,couponBoughtCount:couponBought,couponName:e.brandName,coupondescription:coupondescription,couponDiscount:e.flatDiscount,couponDistance:couponLocation,campaignId:e.campaignId,couponsetId:e.couponsetId}),objCpnData[e.couponsetId]={},objCpnData[e.couponsetId].added=0,objCpnData[e.couponsetId].campaignId=e.campaignId,objCpnData[e.couponsetId].couponsetId=e.couponsetId,objCpnData[e.couponsetId].couponExpiry=e.validUpto,objCpnData[e.couponsetId].nearestOutletId=e.nearestOutletId,objProcCpnData[e.couponsetId]={},objProcCpnData[e.couponsetId].added=0,objProcCpnData[e.couponsetId].campaignId=e.campaignId,objProcCpnData[e.couponsetId].couponsetId=e.couponsetId,objProcCpnData[e.couponsetId].brandName=e.brandName,objProcCpnData[e.couponsetId].flatDiscount=e.flatDiscount,objProcCpnData[e.couponsetId].coupondescription=coupondescription,objProcCpnData[e.couponsetId].couponBoughtCount=couponBought,objProcCpnData[e.couponsetId].couponLocation=couponLocation,objProcCpnData[e.couponsetId].couponImage=e.brandLogo})),conf.couponDetailsData=conf.couponDetailsData.concat(n.couponsets),$("#addCouponsListTemplate").append(addCouponsHtml)):($("#addCouponsListTemplate").html("<h3>No Coupons found</h3>"),$(".shwMoreBtn").hide()),0===n.page.next&&$(".shwMoreBtn").hide())}catch(e){}},conf.fnShowMoreCpns=function(){try{BMS.Misc.fnBusy(!0),BMS.Misc.fnAjax({url:"/serv/getData",type:"GET",dataType:"json",data:{cmd:"GETCOUPONSEATNEW",IsPage:"Y",ReqId:cpnReqId[0],Page:cpnPgNext,TicketQuantity:strQuantity},success:function(e){BMS.Misc.fnBusy(!1),e.page.next<=0&&$(".shwMoreBtn").hide(),conf.fnDisCpnListing(e)},error:function(e){BMS.Misc.fnBusy(!1)}})}catch(e){void 0}},conf.fnShowCoupons=function(){try{$("#venue-coupons").hide(),BMS.Misc.fnAjax({url:"/serv/getData",type:"GET",dataType:"json",data:{cmd:"GETVENUECOUPONDATA",vc:strVenueCode},success:function(e){void 0,1==e.data.couponEnabled?$("#venue-coupons").show():$("#venue-coupons").hide()},error:function(e){BMS.Misc.fnBusy(!1),$("#venue-coupons").hide()}})}catch(e){void 0}},conf.fnAddCouponToCart=function(e){try{var t="";arrCpnAddedData=[],cntAddCpn=0,$(".intialEmptyCoupons").hide(),$(".confirmCpns-wrapper").show(),cpnSetIds.push(e),objCpnData[e].added=1,objProcCpnData[e].added=1,_.each(objProcCpnData,(function(e){1==e.added&&(cntAddCpn++,t+=BMS.Misc.Helpers.render($("#cart-coupon-list-template").html(),{couponImage:e.couponImage,couponBoughtCount:e.couponBoughtCount,couponName:e.brandName,coupondescription:e.coupondescription,couponDiscount:e.flatDiscount,couponDistance:e.couponLocation,couponImage:e.couponImage,couponsetId:e.couponsetId}),$("#coupon-"+e.couponsetId+" .__addCoupons-col-3 .label").hide(),$("#coupon-"+e.couponsetId+" .__addCoupons-col-3 .selectedIcon").show()),BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},{event:"userselectscoupons_Coupon_listing_page_3",action:"GetCouponSelection",label:""+e.brandName})})),2<=cntAddCpn&&($(".shwMoreBtn").hide(),_.each(objProcCpnData,(function(e){1!=e.added&&($("#coupon-"+e.couponsetId).addClass("__disabled"),$("#coupon-"+e.couponsetId+" .__addCoupons-col-3 .label").addClass("__disabled"),$(".shwMoreBtn").addClass("__disabled"))}))),$("#cartCoupons").html(t),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"Coupons Selected",{ProductID:objProcCpnData[e].campaignId,"Event Type":strEventType,"Event Name":strEventName,"Venue Name":strVenueName,Language:strLanguage,Brand:objProcCpnData[e].brandName,Genre:strGenre,place:"coupon listing","Offer Name":objProcCpnData[e].coupondescription,Quantity:strQuantity,Appcode:global.strAppCode})}catch(e){void 0}},conf.fnRemoveCouponFromCart=function(e){try{0!=cpnPgNext&&$(".shwMoreBtn").show(),cntAddCpn-=1,objCpnData[e].added=0,objProcCpnData[e].added=0,cpnSetIds.splice($.inArray(e,cpnSetIds),1),_.each(objProcCpnData,(function(e){1!=e.added&&($("#couponAdded-"+e.couponsetId).remove(),$("#coupon-"+e.couponsetId).removeClass("__disabled"),$("#coupon-"+e.couponsetId+" .__addCoupons-col-3 .label").removeClass("__disabled"),$("#coupon-"+e.couponsetId+" .__addCoupons-col-3 .label").show(),$("#coupon-"+e.couponsetId+" .__addCoupons-col-3 .selectedIcon").hide())})),cntAddCpn<=0&&($(".intialEmptyCoupons").show(),$(".confirmCpns-wrapper").hide()),BMS.Misc.fnPushEventDataToAnalytics(["WR"],"Coupons Deleted",{ProductID:objProcCpnData[e].campaignId,"Event Type":strEventType,"Event Name":strEventName,"Venue Name":strVenueName,Language:strLanguage,Brand:objProcCpnData[e].brandName,Genre:strGenre,place:"coupon listing","Offer Name":objProcCpnData[e].coupondescription,Quantity:strQuantity,Appcode:global.strAppCode})}catch(e){void 0}},conf.fnProceedCoupon=function(){try{BMS.Misc.fnBusy(!0);var e="MT"===strEventType?"confirmation":"confirmationevent";if(cpnCnt=0,_.each(objCpnData,(function(e){1==e.added&&(cpnCnt++,arrCpnAddedData.push(e))})),void 0,0<cpnCnt){var t=JSON.stringify({reqId:cpnReqId[0],transId:lngTransId,couponRequestStatus:e,couponDetails:arrCpnAddedData});BMS.Misc.fnDoTrans({AppC:global.strAppCode,venCode:strVenueCode,transId:lngTransId,cmd:"ADDCOUPONEX",p1:t,blnSupp:!0,fnCC:conf.fnPostConfirm,fnEC:conf.fnErrCoupon})}else{t=JSON.stringify({reqId:cpnReqId[0],transId:lngTransId,couponRequestStatus:e,couponDetails:arrCpnAddedData});BMS.Misc.fnDoTrans({AppC:global.strAppCode,venCode:strVenueCode,transId:lngTransId,cmd:"ADDCOUPONEX",p1:t,blnSupp:!0,fnCC:conf.fnPostConfirm,fnEC:conf.fnErrCoupon})}_.each(objProcCpnData,(function(e){1==e.added&&BMS.Misc.fnPushEventDataToAnalytics(["WR"],"Coupons Purchase",{ProductID:e.campaignId,"Event Type":strEventType,"Event Name":strEventName,"Venue Name":strVenueName,Language:strLanguage,Brand:e.brandName,Genre:strGenre,place:"coupon listing","Offer Name":e.coupondescription,Quantity:strQuantity,Flow:"booking flow",Appcode:global.strAppCode})})),BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},{event:"userselectscoupons_Coupon_listing_page_3",action:"GetCouponsConfirmClick",label:""})}catch(e){BMS.Misc.fnErr({fnName:"conf.fnProceedCoupon",err:e})}},conf.fnOpenBookingConfirmationPage=function(e,t){try{var n=$("#frmConfirmationPagePrint");n.find("[name='lngTransId']").val(e),n.find("[name='BOOKINGID']").val(t),BMS.Misc.fnBusy(!0),n.submit()}catch(e){BMS.Misc.fnErr({fnName:"conf.fnOpenBookingConfirmationPage",err:e})}},conf.fnCloseCpnListModal=function(){try{$("#add-coupon-layout").hide(),location.reload(),$("body").removeClass("_fixed"),$(".intialEmptyCoupons").show(),$(".confirmCpns-wrapper").hide(),$("#addCouponsListTemplate").append(""),$("#cartCoupons").html("")}catch(e){void 0}},conf.fnPostConfirm=function(){try{conf.fnOpenBookingConfirmationPage(lngTransId,lngBookingId),conf.fnCloseCpnListModal(),BMS.Misc.fnBusy(!1)}catch(e){void 0}},conf.fnErrCoupon=function(e){void 0},conf.fnShowCoupModal=function(e){try{var t=conf.couponDetailsData[e],n=t.couponsetId,o="",i="",s="",r="",a="",c="<strong>Redemption Process: </strong>";if($("#showtnc").text("+"),$("#cpTnc").slideUp("slow"),$("#showtnc").unbind("click"),$("#showtnc").bind("click"),$("#offerDis").text(""!=t.offerDescription?t.offerDescription:"NA"),$("#brdName").text(t.brandName),$("#outbought").text(t.boughtCount+" Bought"),$("#valDate,#webvalDate").text(""!=t.validUpto?t.validUpto:"NA"),$("#ActualPrice").text(""!=t.actualPriceRs?"Rs. "+parseFloat(t.actualPriceRs):"NA"),$("#DisplayPrice").text("Rs. "+parseFloat(t.displayPriceRs)),$(".save-rupees-label").text("Save Rs."+parseFloat(t.flatDiscount)+"*"),1!=objCpnData[n].added?($("#btnAddCP").text("Free"),$("#btnAddCP").removeClass("_disable"),$("#btnAddCP").attr("onclick","conf.fnAddCouponToCart('"+n+"'); BMS.Misc.modal('couponTnc', false);")):($("#btnAddCP").attr("onclick",""),$("#btnAddCP").text("Added"),$("#btnAddCP").addClass("_disable")),$("#cpTitel").text(""!=t.outletName?t.outletName:"NA"),$("#outAdd").text(""!=t.outletAddress?t.outletAddress:"NA"),""!=t.mobileNumber&&(o=t.mobileNumber),""!=t.landLine&&(""!=o?o+=", "+t.landLine:o=t.landLine),$("#outMobNo").text(""!=o?o:"NA"),0<t.outletOpeningHours.hours.length){for(var d=0;d<t.outletOpeningHours.hours.length;d++)i+=t.outletOpeningHours.hours[d].from+"-"+t.outletOpeningHours.hours[d].to+"</br>";$("#outTime").html(i)}else $("#outTime").parent().hide();if($("#outNotes").text(t.outletOpeningHours.note),$("#cmpImg").attr("src",t.campaignImage),$(".brdlogo").attr("src",t.brandLogo),0<t.dayOfWeek.length){for(d=0;d<t.dayOfWeek.length;d++){if("ALL_DAYS"==t.dayOfWeek[d]){r+="All Days";break}t.dayOfWeek.length-d<=1?r+=t.dayOfWeek[d]:r+=t.dayOfWeek[d]+","}$("#OutValid").text("Valid On: "+r)}else $("#OutValid").text("NA");if(0<t.cuisineType.length){for(d=0;d<t.cuisineType.length;d++)s+=t.cuisineType[d]+",";$("#restType").text(s.replace(/,\s*$/,""))}else $("#restType").text(t.cuisineType[0].replace(/,\s*$/,""));cntCpnTnC=t.termsAndConditions.split("\n");for(d=0;d<cntCpnTnC.length;d++)a+="<li>"+cntCpnTnC[d].replace("\r","")+"</li>";cntCpnRed=t.redeemProcess.split("\n");for(d=0;d<cntCpnRed.length;d++)c+=cntCpnRed[d].replace("\r","")+"<br/>";$("#cpTnc").html(a),$("#showredCpn").html(c),BMS.Misc.modal("couponTnc",!0),$("#showtnc").click((function(){var e=$.trim($(this).text());$(this).text("-"==e?"+":"-"),"-"==e?$("#cpTnc").slideUp("slow",(function(){})):($("#cpTnc").slideDown("slow",(function(){})),$(".inner_ctnc_desc").animate({scrollTop:$("#showtnc").offset().top},800))}))}catch(e){void 0}},conf.fnGetMusicData=function(){try{BMS.Misc.fnAjax({url:"/serv/getData",type:"GET",dataType:"json",data:{cmd:"GETDEINITDATA"},success:function(e){var t,n=3;e.BookMyShow.hasOwnProperty("AdditionalFeatures")&&(t=(t=e.BookMyShow.AdditionalFeatures.filter((function(e,t){if(e.hasOwnProperty("Music"))return e})))[0].Music.text[0],n="Y"===loyalty.isSubscribed?t.SongExpiryForSuperStarUsersInDays:t.SongExpiryForNormalUsersInDays),$(".music-container").find(".expiry-days").text(n)},error:function(e){BMS.Misc.fnErr({fnName:"conf.fnGetMusicData",err:e})}})}catch(e){BMS.Misc.fnErr({fnName:"conf.fnGetMusicData",err:e})}},conf.whatsAppOptIn=function(){try{var e="js-whatsapp-confirmation",t=document.getElementById(e),n=document.querySelector("#js-whatsapp-confirmation #popUpText"),o=document.querySelector("#js-whatsapp-confirmation #popUpImg");n&&(n.textContent=conf.popUpText),o&&(o.src=conf.popUpImage),t&&(BMS.Modal.fnShowModal(e),BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},{event:"tvc_gtmstdevent_whatsapp",app_code:strAppCode,eventCategory:"whatsapp",eventAction:"opt_in_popup_seen",eventLabel:"","page type":"confirmation"}))}catch(e){BMS.Misc.fnErr({fnName:"conf.whatsAppOptIn",err:e})}},conf.setCustomerPreference=function(e){try{BMS.Misc.fnAjax({url:"/serv/getData",type:"GET",dataType:"json",data:{cmd:"CUSTOMERPREFERENCE",wastatus:e&&e.toLowerCase(),transid:lngTransId,bookingid:strBookingId,mobile:strMemberMobile,v:Math.random()}})}catch(e){BMS.Misc.fnErr({fnName:"conf.whatsAppOptIn",err:e})}},conf.dismissWhatsApp=function(){try{BMS.Modal.fnHideModal("js-whatsapp-confirmation")}catch(e){BMS.Misc.fnErr({fnName:"conf.dismissWhatsApp",err:e})}},conf.hideModal=function(){conf.setCustomerPreference("N"),BMS.Modal.fnShowModal("js-whatsapp-no-modal"),setTimeout((function(){BMS.Modal.fnHideModal("js-whatsapp-no-modal")}),4e3),BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},{event:"tvc_gtmstdevent_whatsapp",app_code:strAppCode,eventCategory:"whatsapp",eventAction:"no",eventLabel:"","page type":"confirmation"})},conf.handleYesClick=function(){conf.setCustomerPreference("Y"),BMS.Modal.fnShowModal("js-whatsapp-success"),setTimeout((function(){BMS.Modal.fnHideModal("js-whatsapp-success")}),4e3),BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},{event:"tvc_gtmstdevent_whatsapp",app_code:strAppCode,eventCategory:"whatsapp",eventAction:"yes",eventLabel:"","page type":"confirmation"})},conf.timeOut="10000",conf.fnOpenReward=function(e){try{var t="";BMS.Storage.isset({name:"Rgn",key:"subregionDetails"})&&(t=(t=BMS.Storage.get({name:"Rgn",key:"subregionDetails"}))?JSON.parse(t):""),BMS.Misc.fnPushEventDataToAnalytics(["GA","WR"],"Reward Pop Up",{Eligible:reward?"Yes":"No","Reward Id":reward&&reward.referenceId?reward.referenceId:"",Clicked:"Yes","Logged In":""!=BMS.Storage.get({name:"ld"})?"Yes":"No",Appcode:global.strAppCode},{eventCategory:"reward_popup_clicked",eventAction:"click",eventLabel:"",title:strEventName,pagetype:"purchase_completion",page_url:location.href,tvc_userid:BMS.Storage.get({name:"ld",key:"MEMBERID"}),bms_id:BMS.Storage.get({name:"bmsId"}),session_id:BMS.Storage.get({name:"mqttsid"}),region_code:BMS.Storage.get({name:"Rgn",key:"Code"}),sub_region_code:t,product:strEventType,event_code:strEventCode,event_group:"",user_mode:""!=BMS.Storage.get({name:"ld"})?"logged_in":"guest",app_code:global.strAppCode,user_langauage:BMS.Storage.get({name:"lang"})}),window.location.href=e}catch(e){BMS.Misc.fnErr({fnName:"conf.fnOpenReward",err:e})}};var costDetails,splitType,receiversAmount,ticketArr,userMobileNo,count=0,ticketQty=0,totalTickets=0,sendTicket=!1,haltFlag=!1,friendDetailsArr=[],doneSplitCost=!1,doneSplitTicket=!1,continueSplitCost=!1,userDataFromSplitTicketForCost=[],mticketSuccess=!1,noFriends=0,dontCloneFriendsCost=!1,dontCloneFriendsBoth=!1,dontCloneFriendsTicket=!1,splitCostError=!1,failedSenderNames=[],costSuccessCount=0,fromContinueSplitCost=!1,nonLoginSplitTicket=!1,fromGetPaymentMethod=!1,doNotShowSumary=!1;function fnGetBookingInfo(){try{BMS.Misc.fnWsData({strApp:global.strAppCode,transId:lngTransId,cmd:"GETBOOKINGDETAILSEX",retType:"json",data:escape("|TRANSID="+lngTransId+"|BOOKINGID="+bIdBeforeSplit+"|"),fnCC:function(e){var t=JSON.parse(decodeURIComponent(e));if(t.BookMyShow.SplitMTicket?splitData=t.BookMyShow.SplitMTicket:splitData=[],BMS.Storage.isset({name:"ld"})||1!=nonLoginSplitTicket||0==splitData.length){if(0!=splitData.length)for(i=0;i<splitData.length;i++)"P"==splitData[i].Trans_strUserStatus&&($(".qyt").html("Quantity: "+splitData[i].Trans_intQuantity),$(".__qrcode img").attr("src","https://"+location.host+"/secure/barcode/?IsImage=Y&strBarcodeType=qrcode&strBarcodeTxt="+splitData[i].Trans_strQRCodeText+"&intHeight=100&intWidth=100"),$(".__booking-id").html("Booking ID <br> <strong>"+splitData[i].Trans_strBookingId+"</strong>"))}else{void 0,nonLoginSplitTicket=!1;for(var n,o=0,i=0;i<splitData.length;i++){var s;if(s=1<parseInt(splitData[i].Trans_intQuantity)?splitData[i].Trans_intQuantity+" Tickets":splitData[i].Trans_intQuantity+" Ticket","P"==splitData[i].Trans_strUserStatus)$(".qyt").html("Quantity: "+splitData[i].Trans_intQuantity),$(".__qrcode img").attr("src","https://"+location.host+"/secure/barcode/?IsImage=Y&strBarcodeType=qrcode&strBarcodeTxt="+splitData[i].Trans_strQRCodeText+"&intHeight=100&intWidth=100"),$(".__booking-id").html("Booking ID <br> <strong>"+splitData[i].Trans_strQRCodeText+"</strong>"),$("#msuccess-tickets").text(s),$("#msuccess-bookingId").text("Booking ID: "+splitData[i].Trans_strBookingId),$("#msuccess-number").text(splitData[i].Trans_strUserMobile);else if(0==o)o+=1,$("#msuccess-friend-name-0").text(splitData[i].Trans_strUserName),$("#msuccess-friend-tickets-0").text(s),$("#msuccess-friend-bookingId-0").text("Booking ID: "+splitData[i].Trans_strBookingId),$("#msuccess-friend-number-0").text(splitData[i].Trans_strUserMobile);else{var r=document.getElementById("friends-mticket-0"),a=r.cloneNode(!0);a.id="friends-mticket-"+o,$(a).addClass("remove-friend"),$(a).find(".friend-name").attr("id","msuccess-friend-name-"+o),$(a).find(".no-tickets").attr("id","msuccess-friend-tickets-"+o),$(a).find(".phone-no").attr("id","msuccess-friend-number-"+o),$(a).find(".your-bId").attr("id","msuccess-friend-bookingId-"+o),$(a).find("#msuccess-friend-name-"+o).text(splitData[i].Trans_strUserName),$(a).find("#msuccess-friend-tickets-"+o).text(s),$(a).find("#msuccess-friend-number-"+o).text(splitData[i].Trans_strUserMobile),$(a).find("#msuccess-friend-bookingId-"+o).text("Booking ID: "+splitData[i].Trans_strBookingId),r.parentNode.appendChild(a),o+=1}}$("#cost-success-summary").hide(),$("#success-summary").hide(),$("#mticket-success-summary").show(),$("#mticket-cost-failure").hide(),doNotShowSumary?doNotShowSumary=!1:(BMS.Misc.modal("splitBookingSuccess",!0),BMS.Misc.fnBusy(!1,$(".body"))),splitType="cost",$("#btnProceedToDetails").attr("onclick"," conf.fnGetPaymentDetails();"),$("#btnProceedToDetails").css("opacity",1),n=1<o?"You have sent individual m-tickets to "+o+" friends":"You have sent individual m-ticket to "+o+" friend",$("#no-friends").text(n),$("#booking-done").show(),$(".split-mticket").css("opacity",.5),$("#sendMtickets").prop("disabled",!0),$(".already-ticket-split-error").show(),$("#split-type-prefilled").text("SPLIT TICKET COST")}},fnEC:function(e){void 0}})}catch(e){BMS.Misc.fnErr({fnName:"fnGetBookingInfo",err:e})}}conf.fnSplitBooking=function(){try{if(count=0,splitCostError=!1,$(".remove-details").remove(),ticketQty=totalTickets-1,$(".split-exceeded-error").hide(),$("#add-another-friend").addClass("_disabled"),$("#add-another-friend").css("opacity",.5),$("#add-another-friend").attr("onclick",""),$("#add-another-friend").show(),$(".incr-ticket").attr("onclick","conf.fnIncrTicket(this.id);"),$(".incr-ticket").removeClass("_disabled"),$(".incr-ticket").css("opacity",1),$("#input-container-0").hide(),$("#delete_confirmation-0").hide(),$("#details_container-0").show(),$("#tickets-0").text(""),$(".split-error").hide(),$("#valid_tick-0").hide(),$("#your_number-0").removeClass("changeBorder"),failedSenderNames=[],BMS.Misc.modal("splitBooking",!0),$("#splitTicketCost").prop("checked",!0),$("#sendMtickets").prop("checked",!0),BMS.Misc.fnBusy(!0,$(".body")),BMS.Storage.isset({name:"ld"})){conf.fnGetMemberHistory("X")}else BMS.Misc.fnBusy(!1,$(".body"))}catch(e){BMS.Misc.fnErr({fnName:"conf.fnSplitBooking",err:e})}},conf.fnGetWalletDetails=function(){"N"==cinemaHasMticketSplit?($(".split-mticket").css("opacity",.5),$("#sendMtickets").prop("disabled",!0),$(".cinema-error").show(),doneSplitCost?($("#btnProceedToDetails").attr("onclick",""),$("#btnProceedToDetails").css("opacity",.5)):$("#splitTicketCost").prop("checked")&&!$("#splitTicketCost").prop("disabled")&&($("#btnProceedToDetails").attr("onclick","conf.fnSplitBookingDetails();"),$("#btnProceedToDetails").css("opacity",1)),BMS.Misc.fnBusy(!1,$(".body"))):"N"==userHasMticket?($(".split-mticket").css("opacity",.5),$("#sendMtickets").prop("disabled",!0),$(".box-office-pickup-error").show(),doneSplitCost?($("#btnProceedToDetails").attr("onclick",""),$("#btnProceedToDetails").css("opacity",.5)):$("#splitTicketCost").prop("checked")&&!$("#splitTicketCost").prop("disabled")&&($("#btnProceedToDetails").attr("onclick","conf.fnSplitBookingDetails();"),$("#btnProceedToDetails").css("opacity",1)),BMS.Misc.fnBusy(!1,$(".body"))):"Y"==userMticketSplitDone||1==doneSplitCost||1==doneSplitTicket?"Y"!=userMticketSplitDone&&1!=doneSplitTicket||1!=doneSplitCost?"Y"==userMticketSplitDone||1==doneSplitTicket?($(".split-mticket").css("opacity",.5),$("#sendMtickets").prop("disabled",!0),$(".already-ticket-split-error").show(),$("#btnProceedToDetails").attr("onclick","conf.fnGetPaymentDetails();"),$("#btnProceedToDetails").css("opacity",1),BMS.Misc.fnBusy(!1,$(".body"))):1==doneSplitCost&&($(".split-cost").css("opacity",.5),$("#splitTicketCost").prop("disabled",!0),$(".already-cost-split-error").show(),$("#btnProceedToDetails").attr("onclick","conf.fnPrefilledDetails();"),$("#btnProceedToDetails").css("opacity",1),BMS.Misc.fnBusy(!1,$(".body"))):($(".split-mticket").css("opacity",.5),$("#sendMtickets").prop("disabled",!0),$(".already-ticket-split-error").show(),$(".split-cost").css("opacity",.5),$("#splitTicketCost").prop("disabled",!0),$(".already-cost-split-error").show(),$("#btnProceedToDetails").attr("onclick",""),$("#btnProceedToDetails").css("opacity",.5),BMS.Misc.fnBusy(!1,$(".body"))):($("#btnProceedToDetails").attr("onclick","conf.fnSplitBookingDetails();"),$("#btnProceedToDetails").css("opacity",1),BMS.Misc.fnBusy(!1,$(".body")))},conf.fnSplitBookingDetails=function(){try{BMS.Storage.isset({name:"ld"})||!$("#splitTicketCost").is(":checked")||$("#splitTicketCost").prop("disabled")?BMS.Storage.isset({name:"ld"})&&("B"==BMS.Storage.get({name:"ld",key:"WALLETSTATUS"})||""==BMS.Storage.get({name:"ld",key:"WALLETSTATUS"}))&&$("#splitTicketCost").prop("checked")?(BMS.Storage.set({name:"split-booking",value:!0,storage:"C"}),BMS.Storage.set({name:"beforeSplit-bookingID",value:bIdBeforeSplit,storage:"C"}),BMS.Storage.set({name:"split-transId",value:lngTransId,storage:"C"}),window.location=location.protocol+"//"+location.hostname+"/myprofile/mywallet"):("A"==BMS.Storage.get({name:"ld",key:"WALLETSTATUS"})||$("#sendMtickets").prop("checked")&&!$("#sendMtickets").prop("disabled"))&&(BMS.Misc.modal("splitBookingDetails",!0),BMS.Misc.fnBusy(!0,$(".body")),conf.fnSplitSelection()):(BMS.SignIn.fnSignIn(!0),null==global.SignInCallBack&&(global.SignInCallBack=[]),global.SignInCallBack.push((function(){setTimeout((function(){conf.fnGetMemberHistory("V")}),1e3)})))}catch(e){BMS.Misc.fnErr({fnName:"conf.fnSplitBookingDetails",err:e})}},conf.fnSplitSelection=function(){try{$("#btnConfirmDetails").attr("onclick",""),$("#btnConfirmDetails").css("opacity",.5),$("#input-container-0").show(),$("#delete_friend-0").hide(),!$("#splitTicketCost").prop("disabled")&&!$("#sendMtickets").prop("disabled")&&$("#splitTicketCost").is(":checked")&&$("#sendMtickets").is(":checked")?(splitType="B",$("#split-type").text("SPLIT BOOKING"),sendTicket=!1,conf.fnSplitCost()):!$("#splitTicketCost").prop("disabled")&&$("#splitTicketCost").is(":checked")?(splitType="C",$("#split-type").text("SPLIT TICKET COST"),$(".phone-number").text(userMobileNo),sendTicket=!1,conf.fnSplitCost()):!$("#sendMtickets").prop("disabled")&&$("#sendMtickets").is(":checked")&&(splitType="M",$("#split-type").text("SEND TICKET"),$(".phone-number").text(userMobileNo),sendTicket=!0,conf.fnSendTicket())}catch(e){BMS.Misc.fnErr({fnName:"conf.fnSplitSelection",err:e})}},conf.fnAddFriend=function(){if(0<ticketQty){var e=++count,t=document.getElementById("input-container-0"),n=t.cloneNode(!0);if(n.id="input-container-"+e,$(n).addClass("remove-details"),$(n).addClass("friend-details"),$(n).find(".delete-friend").attr("id","delete_friend-"+e),$(n).find(".confirm-delete").attr("id","confirm_delete-"+e),$(n).find(".cancel-delete").attr("id","cancel_delete-"+e),$(n).find("#details_container-0").attr("id","details_container-"+e),$(n).find(".delete-confirmation").attr("id","delete_confirmation-"+e),$(n).find("#friend_name-0").attr("id","friend_name-"+e),$(n).find(".delete-friend").show(),$(n).find(".total-tickets").attr("id","total_tickets-"+e),$(n).find(".total-amount").attr("id","total_amount-"+e),$(n).find("#incr_ticket-0").attr("id","incr_ticket-"+e),$(n).find("#valid_tick-0").attr("id","valid_tick-"+e),$(n).find("#decr_ticket-0").attr("id","decr_ticket-"+e),$(n).find("#your_name-0").attr("id","your_name-"+e),$(n).find("#your_number-0").attr("id","your_number-"+e),$(n).find("#mobile_error-0").attr("id","mobile_error-"+e),$(n).find("#same_no_error-0").attr("id","same_no_error-"+e),$(n).find("#own_no_error-0").attr("id","own_no_error-"+e),$(n).find("#your_number-"+e).attr("placeholder","MOBILE NO"),$(n).find("#your_name-"+e).attr("placeholder","NAME"),$(n).find("#your_number-"+e).val(""),$(n).find("#your_number-"+e).removeClass("changeBorder"),$(n).find("#your_name-"+e).val(""),$(n).find("#total_tickets-"+e).text("1"),$(n).find("#mobile_error-"+e).hide(),$(n).find("#same_no_error-"+e).hide(),$(n).find("#delete_confirmation-"+e).hide(),$(n).find("#details_container-"+e).show(),$(n).find("#valid_tick-"+e).hide(),$(n).show(),ticketQty-=1,sendTicket){if(sendTicket){var o;o=1<ticketQty?" Tickets":" Ticket",$("#total-tickets").text(ticketQty),$("#total-amount").text(o),$(n).find("#total_amount-"+e).text(" Ticket")}}else o=1<ticketQty?" Tickets (Rs. "+costDetails.BookMyShow.data["Ticket Cost"][0][ticketQty]+")":" Ticket (Rs. "+costDetails.BookMyShow.data["Ticket Cost"][0][ticketQty]+")",$("#total-tickets").text(ticketQty),$("#total-amount").text(o),$(n).find("#total_amount-"+e).text(" Ticket (Rs. "+costDetails.BookMyShow.data["Ticket Cost"][0][1]+")");t.parentNode.appendChild(n),conf.fnBindPaste("your_number-"+e),$("#btnConfirmDetails").attr("onclick",""),$("#btnConfirmDetails").css("opacity",.5),1==ticketQty?($("#add-another-friend").attr("onclick","conf.fnDisplayLimit();"),$("#add-another-friend").addClass("_disabled"),$("#add-another-friend").css("opacity",.5),$("#add-another-friend").hide(),$(".incr-ticket").attr("onclick","conf.fnDisplayLimit();"),$(".incr-ticket").addClass("_disabled"),$(".incr-ticket").css("opacity",.5)):($("#add-another-friend").attr("onclick",""),$("#add-another-friend").addClass("_disabled"),$("#add-another-friend").css("opacity",.5))}},conf.fnBindPaste=function(e){$("#"+e).on("paste",(function(){setTimeout('$("#'+e+'").keyup();',500)}))},conf.fnShowDeletePopUp=function(e){e=e.split("-");var t,n=$(".friend-details").length;t=""!=$("#your_name-"+e[1]).val()?$("#your_name-"+e[1]).val().toUpperCase():"this contact?",2==n?(1<parseInt($(".friend-details").find(".total-tickets").text())||""!=$(".friend-details").find(".no").val())&&($("#details_container-"+e[1]).hide(),$("#friend_name-"+e[1]).text(t),$("#delete_confirmation-"+e[1]).show()):2<n&&($("#details_container-"+e[1]).hide(),$("#friend_name-"+e[1]).text(t),$("#delete_confirmation-"+e[1]).show())},conf.fnCancelDelete=function(e){e=e.split("-");$("#delete_confirmation-"+e[1]).hide(),$("#details_container-"+e[1]).show()},conf.fnDeleteFriend=function(e){e=(a=e).split("-"),$(".input-container").length;var t=$("#total_tickets-"+e[1]).text(),n=0;if($.each($(".friend-details"),(function(){$(this).is(":visible")&&(n+=1)})),$(".split-exceeded-error").hide(),1==n){if(""==$("#your_number-"+e[1]).val()&&1==parseInt($("#total_tickets-"+e[1]).text()))haltFlag=!0;else{var o=parseInt(t)-1;ticketQty+=o}$("#your_name-"+e[1]).val(""),$("#your_number-"+e[1]).val(""),$("#your_number-"+e[1]).removeClass("changeBorder"),$("#your_name-"+e[1]).attr("placeholder","NAME"),$("#your_number-"+e[1]).attr("placeholder","MOBILE NO"),"M"!=splitType?($("#total_tickets-"+e[1]).text(1),$("#total_amount-"+e[1]).text(" Ticket (Rs. "+costDetails.BookMyShow.data["Ticket Cost"][0][1]+")")):($("#total_tickets-"+e[1]).text(1),$("#total_amount-"+e[1]).text(" Ticket")),$("#btnConfirmDetails").attr("onclick",""),$("#btnConfirmDetails").css("opacity",.5),$("#details_container-"+e[1]).show(),$("#delete_confirmation-"+e[1]).hide(),$("#delete_friend-"+e[1]).hide(),$("#mobile_error-"+e[1]).hide(),$("#same_no_error-"+e[1]).hide(),$("#own_no_error-"+e[1]).hide(),$("#valid_tick-"+e[1]).hide()}else ticketQty+=parseInt(t),"confirm_delete-0"!=a?$("#input-container-"+e[1]).remove():($("#your_name-0").val(""),$("#your_number-0").val(""),$("#your_name-0").attr("placeholder","NAME"),$("#your_number-0").attr("placeholder","MOBILE NO"),$("#input-container-0").removeClass("remove-details"),$("#mobile_error-0").hide(),$("#same_no_error-0").hide(),$("#input-container-0").hide());var i=0,s=!1,r=!1;$.each($(".sender"),(function(){$(this).is(":visible")&&0==$(this).val().length&&(i+=1,$("#btnConfirmDetails").attr("onclick",""),$("#btnConfirmDetails").css("opacity",.5),r=!0)})),$.each($(".split-error"),(function(){$(this).is(":visible")&&(r=s=!0)})),0==i&&0==s&&($("#btnConfirmDetails").attr("onclick","conf.fnGetFriendsDetails();"),$("#btnConfirmDetails").css("opacity",1));var a,c=0;if($.each($(".friend-details"),(function(){if($(this).is(":visible")&&0==$(this).val().length){c+=1;var e=this.id.split("-");a=e[2]}})),1==c){var d=a.split("-");""==$("#your_name-"+d[1]).val()&&""==$("#your_number-"+d[1]).val()&&$("#delete_friend-"+a).hide()}if(1<ticketQty&&(r?($("#add-another-friend").addClass("_disabled"),$("#add-another-friend").css("opacity",.5),$("#add-another-friend").attr("onclick","")):($("#add-another-friend").removeClass("_disabled"),$("#add-another-friend").css("opacity",1),$("#add-another-friend").attr("onclick","conf.fnAddFriend();")),$("#add-another-friend").show(),$(".incr-ticket").attr("onclick","conf.fnIncrTicket(this.id);"),$(".incr-ticket").removeClass("_disabled"),$(".incr-ticket").css("opacity",1)),sendTicket){if(sendTicket){var l;l=1<ticketQty?" Tickets":" Ticket",$("#total-tickets").text(ticketQty),$("#total-amount").text(l)}}else l=1<ticketQty?" Tickets (Rs. "+costDetails.BookMyShow.data["Ticket Cost"][0][ticketQty]+")":" Ticket (Rs. "+costDetails.BookMyShow.data["Ticket Cost"][0][ticketQty]+")",$("#total-tickets").text(ticketQty),$("#total-amount").text(l);$.each($(".split-error"),(function(){$(this).is(":visible")&&conf.fnValidateDetails(this.id)}))},conf.fnIncrTicket=function(e){var t=e.split("-"),n=$("#total_tickets-"+t[1]).text();n=parseInt(n)+1;$("#total-tickets").text();var o=ticketQty-=1;if(0<ticketQty)var i=costDetails.BookMyShow.data["Ticket Cost"][0][n],s=costDetails.BookMyShow.data["Ticket Cost"][0][o];if(1<n&&($("#decr_ticket-"+t[1]).removeClass("_disabled"),$("#decr_ticket-"+t[1]).css("opacity",1),$("#decr_ticket-"+t[1]).attr("onclick","conf.fnDecrTicket(this.id);")),sendTicket){if(sendTicket){var r,a;r=1<n?" Tickets":" Ticket",$("#total_tickets-"+t[1]).text(n),$("#total_amount-"+t[1]).text(r),a=1<o?" Tickets":" Ticket",$("#total-tickets").text(o),$("#total-amount").text(a)}}else r=1<n?" Tickets (Rs."+i+")":" Ticket (Rs."+i+")",$("#total_tickets-"+t[1]).text(n),$("#total_amount-"+t[1]).text(r),a=1<o?" Tickets (Rs."+s+")":" Ticket (Rs."+s+")",$("#total-tickets").text(o),$("#total-amount").text(a);1==ticketQty&&($("#add-another-friend").attr("onclick","conf.fnDisplayLimit();"),$("#add-another-friend").addClass("_disabled"),$("#add-another-friend").css("opacity",.5),$("#add-another-friend").hide(),$(".incr-ticket").attr("onclick","conf.fnDisplayLimit();"),$(".incr-ticket").addClass("_disabled"),$(".incr-ticket").css("opacity",.5))},conf.fnDecrTicket=function(e){ticketQty+=1;var t=e.split("-"),n=$("#total_tickets-"+t[1]).text();n=parseInt(n)-1;var o=ticketQty,i=costDetails.BookMyShow.data["Ticket Cost"][0][o],s=costDetails.BookMyShow.data["Ticket Cost"][0][n],r=!1;if($.each($(".sender"),(function(){$(this).is(":visible")&&0==$(this).val().length&&(1,$("#btnConfirmDetails").attr("onclick",""),$("#btnConfirmDetails").css("opacity",.5),r=!0)})),$.each($(".split-error"),(function(){$(this).is(":visible")&&(r=!0)})),$(".split-exceeded-error").hide(),0<n)if(sendTicket){if(sendTicket){var a,c;a=1<n?" Tickets":" Ticket",c=1<o?" Tickets":" Ticket",$("#total_tickets-"+t[1]).text(n),$("#total_amount-"+t[1]).text(a),$("#total-tickets").text(o),$("#total-amount").text(c)}}else a=1<n?" Tickets (Rs."+s+")":" Ticket (Rs."+s+")",c=1<o?" Tickets (Rs."+i+")":" Ticket (Rs."+i+")",$("#total_tickets-"+t[1]).text(n),$("#total_amount-"+t[1]).text(a),$("#total-tickets").text(o),$("#total-amount").text(c);1==n&&($("#decr_ticket-"+t[1]).removeAttr("onclick"),$("#decr_ticket-"+t[1]).addClass("_disabled"),$("#decr_ticket-"+t[1]).css("opacity",.5)),1<ticketQty&&(r?($("#add-another-friend").addClass("_disabled"),$("#add-another-friend").css("opacity",.5),$("#add-another-friend").attr("onclick","")):($("#add-another-friend").removeClass("_disabled"),$("#add-another-friend").css("opacity",1),$("#add-another-friend").attr("onclick","conf.fnAddFriend();")),$("#add-another-friend").show(),$(".incr-ticket").attr("onclick","conf.fnIncrTicket(this.id);"),$(".incr-ticket").removeClass("_disabled"),$(".incr-ticket").css("opacity",1))},conf.fnSplitCost=function(){BMS.Misc.fnWsData({AppC:global.strWltAppCode,cmd:"GETTRANSACTIONSPLITPAYMENTDETAILS",data:"|TRANSID="+strTransId+"|BOOKINGID="+strBookingId+"|",type:"POST",retType:"json",blnSupp:!0,fnCC:function(e){var t,n,o=JSON.parse(decodeURIComponent(e));costDetails=o,totalTickets=parseInt(o.BookMyShow.data.Quantity),1<(ticketQty=totalTickets-1)?(t="  Tickets (Rs. "+o.BookMyShow.data["Ticket Cost"][0][ticketQty]+")",n="Add up to "+ticketQty+" contacts"):(t="  Ticket (Rs. "+o.BookMyShow.data["Ticket Cost"][0][ticketQty]+")",n="Add up to "+ticketQty+" contact"),$("#total-tickets-summary").text("Total - "+o.BookMyShow.data.Quantity+" tickets (Rs. "+o.BookMyShow.data["Total Amount"]+")"),$(".remaining-ticket").text(n),$("#split-tickets-count").val(totalTickets-1),$("#receivers-no").text(userMobileNo),$("#total-tickets").text(ticketQty+" "),$("#total-amount").text(t),$("#total_tickets-0").text("1 "),$("#total_amount-0").text(" Ticket (Rs. "+o.BookMyShow.data["Ticket Cost"][0][1]+")"),$("#decr_ticket-0").removeAttr("onclick"),$("#decr_ticket-0").addClass("_disabled"),$("#decr_ticket-0").css("opacity",.5),1==ticketQty&&($("#add-another-friend").attr("onclick","conf.fnDisplayLimit();"),$("#add-another-friend").addClass("_disabled"),$("#add-another-friend").css("opacity",.5),$("#add-another-friend").hide(),$(".incr-ticket").attr("onclick","conf.fnDisplayLimit();"),$(".incr-ticket").addClass("_disabled"),$(".incr-ticket").css("opacity",.5)),BMS.Misc.fnBusy(!1,$(".body"))}})},conf.fnSendTicket=function(){BMS.Misc.fnWsData({AppC:global.strWltAppCode,cmd:"GETTRANSACTIONSPLITPAYMENTDETAILS",data:"|TRANSID="+strTransId+"|BOOKINGID="+strBookingId+"|",type:"POST",retType:"json",blnSupp:!0,fnCC:function(e){var t,n,o=JSON.parse(decodeURIComponent(e));costDetails=o,totalTickets=parseInt(o.BookMyShow.data.Quantity),1<(ticketQty=totalTickets-1)?(t=" Tickets",n="Add up to "+ticketQty+" contacts"):(t=" Ticket",n="Add up to "+ticketQty+" contact"),$("#total-tickets-summary").text("Total - "+o.BookMyShow.data.Quantity+" tickets"),$(".remaining-ticket").text(n),$("#split-tickets-count").val(totalTickets-1),$("#receivers-no").text(userMobileNo),$("#total-tickets").text(ticketQty),$("#total-amount").text(t),$("#total_tickets-0").text("1"),$("#total_amount-0").text(" Ticket"),$("#decr_ticket-0").removeAttr("onclick"),$("#decr_ticket-0").addClass("_disabled"),$("#decr_ticket-0").css("opacity",.5),1==ticketQty&&($("#add-another-friend").attr("onclick","conf.fnDisplayLimit();"),$("#add-another-friend").addClass("_disabled"),$("#add-another-friend").css("opacity",.5),$("#add-another-friend").hide(),$(".incr-ticket").attr("onclick","conf.fnDisplayLimit();"),$(".incr-ticket").addClass("_disabled"),$(".incr-ticket").css("opacity",.5)),BMS.Misc.fnBusy(!1,$(".body"))}})},conf.fnValidateData=function(e){e.split("-"),$("#your_number-"+rmId[1]).val().length;if((""==$("#your_name-"+rmId[1]).val()||""==$("#your_name-"+rmId[1]).val().trim())&&0==$("#your_number-"+rmId[1]).val().length){var t=0;$.each($(".friend-details"),(function(){$(this).is(":visible")&&(t+=1)})),1==t&&$("#delete_friend-"+rmId[1]).hide()}$.each($(".split-error"),(function(){$(this).is(":visible")&&!0}))},conf.fnValidateDetails=function(e){var t=e.split("-"),n=$(".no").length,o=!1,i=$("#your_number-"+t[1]).val().length;if((""==$("#your_name-"+t[1]).val()||""==$("#your_name-"+t[1]).val().trim())&&0==$("#your_number-"+t[1]).val().length){var s=0;$.each($(".friend-details"),(function(){$(this).is(":visible")&&(s+=1)})),1==s&&$("#delete_friend-"+t[1]).hide()}$.each($(".split-error"),(function(){$(this).is(":visible")&&!0}));var r=0;if($.each($(".sender"),(function(){if($(this).is(":visible")&&(0!=$("#"+this.id).val().length&&""!=$("#"+this.id).val().trim()||(r+=1,$("#btnConfirmDetails").attr("onclick",""),$("#btnConfirmDetails").css("opacity",.5),o=!0),$("#"+this.id).hasClass("no")&&10!=$("#"+this.id).val().length&&this.id!="your_number-"+t[1])){var e=this.id.split("-");r+=1,$("#mobile_error-"+e[1]).show(),$("#valid_tick-"+t[1]).hide(),$("#btnConfirmDetails").attr("onclick",""),$("#btnConfirmDetails").css("opacity",.5),o=!0}})),0!=r&&($("#btnConfirmDetails").attr("onclick",""),$("#btnConfirmDetails").css("opacity",.5),o=!0),""!=$("#your_name-"+t[1]).val()&&""!=$("#your_name-"+t[1]).val().trim()&&10==$("#your_number-"+t[1]).val().length?$("#delete_friend-"+t[1]).is(":visible")||$("#delete_friend-"+t[1]).show():10!=$("#your_number-"+t[1]).val().length&&($("#btnConfirmDetails").attr("onclick",""),$("#btnConfirmDetails").css("opacity",.5),$("#same_no_error-"+t[1]).hide(),$("#own_no_error-"+t[1]).hide(),$("#valid_tick-"+t[1]).hide(),o=!0),""==$("#your_number-"+t[1]).val()&&($("#mobile_error-"+t[1]).hide(),$("#same_no_error-"+t[1]).hide(),$("#own_no_error-"+t[1]).hide(),$("#valid_tick-"+t[1]).hide(),o=!0),10==i){BMS.Validate.mob($("#your_number-"+t[1]).val())?BMS.Validate.mob($("#your_number-"+t[1]).val())&&($("#mobile_error-"+t[1]).hide(),$("#valid_tick-"+t[1]).show()):($("#btnConfirmDetails").attr("onclick",""),$("#btnConfirmDetails").css("opacity",.5),$("#mobile_error-"+t[1]).show(),$("#valid_tick-"+t[1]).hide(),o=!0);for(var a={},c=0;c<n;c++)for(var d=$(".no")[c].id,l=$(".no")[c].value,f=0;f<n;f++){var p=$(".no")[f].id,u=$(".no")[f].value;a[d]||(a[d]=!1),d==p||l!=u&&l!=userMobileNo?d==p&&l==userMobileNo&&(a[d]="own-no"):a[d]=l!=userMobileNo||"own-no"}if(0!=Object.keys(a).length)for(var m in a){e=m.split("-");"own-no"==a[m]?($("#own_no_error-"+e[1]).show(),$("#same_no_error-"+e[1]).hide(),$("#valid_tick-"+e[1]).hide(),o=!0):1==a[m]?($("#same_no_error-"+e[1]).show(),$("#own_no_error-"+e[1]).hide(),$("#valid_tick-"+e[1]).hide(),o=!0):($("#same_no_error-"+e[1]).hide(),$("#own_no_error-"+e[1]).hide(),$("#mobile_error-"+e[1]).is(":visible")||$("#valid_tick-"+e[1]).show())}else $("#same_no_error-"+e[1]).hide(),$("#own_no_error-"+e[1]).hide(),$("#mobile_error-"+e[1]).is(":visible")||$("#valid_tick-"+e[1]).show()}1==o&&($("#add-another-friend").attr("onclick",""),$("#add-another-friend").addClass("_disabled"),$("#add-another-friend").css("opacity",.5),$("#btnConfirmDetails").attr("onclick",""),$("#btnConfirmDetails").css("opacity",.5));var M={};for(var h in $.each($(".split-error"),(function(){var e=this.id.split("-");$(this).is(":visible")?(M["#your_number-"+e[1]]||(M["#your_number-"+e[1]]=!1),M["#your_number-"+e[1]]=!0):(M["#your_number-"+e[1]]||(M["#your_number-"+e[1]]=!1),M["#your_number-"+e[1]]||(M["#your_number-"+e[1]]=!1))})),M)M[h]?$(h).addClass("changeBorder"):$(h).removeClass("changeBorder");0!=r||$(".split-error").is(":visible")||0!=o||($("#btnConfirmDetails").attr("onclick","conf.fnGetFriendsDetails();"),$("#btnConfirmDetails").css("opacity",1),$("#add-another-friend").removeClass("_disabled"),$("#add-another-friend").css("opacity",1),$("#add-another-friend").attr("onclick","conf.fnAddFriend();"))},conf.fnValidateName=function(){var n=$(".dynamic-name").length;n-=1;var o=!1;$(".dynamic-name").each((function(e,t){""!=$("#"+this.id).val()&&""!=$("#"+this.id).val().trim()?o=!0:(o=!1,$("#btnConfirmPrefilledDetails").attr("onclick",""),$("#btnConfirmPrefilledDetails").css("opacity",.5)),e==n&&o&&($("#btnConfirmPrefilledDetails").attr("onclick","conf.fnGetFriendsDetails();"),$("#btnConfirmPrefilledDetails").css("opacity",1))}))},conf.fnGetFriendsDetails=function(){var i=!1;BMS.Misc.fnBusy(!0,$(".body"));var e=$(".friend-details").length;noFriends=e-=1;var s,r=!1,a=[];if("ticket"==splitType||"cost"==splitType)var c="|NAME="+BMS.Storage.get({name:"ld",key:"WALLETFIRSTNAME"})+"|MOBILE="+userMobileNo+"|QTY="+$("#prefilled-total-tickets").text()+"|USERSTATUS=P|";else c="|NAME="+BMS.Storage.get({name:"ld",key:"WALLETFIRSTNAME"})+"|MOBILE="+userMobileNo+"|QTY="+$("#total-tickets").text()+"|USERSTATUS=P|";var d=0;$.each($(".friend-details"),(function(){$(this).is(":visible")&&(d+=1)}));var l=0;$.each($(".friend-details"),(function(){if($(this).is(":visible")){l+=1;var e,t=this.id.split("-")[2];if("ticket"==splitType||"cost"==splitType){var n=$("#tickets-"+t).text();if(s=receiversAmount,""!=$("#prefilled-your_name-"+t).text()&&null!=$("#prefilled-your_name-"+t).text()&&""!=$("#prefilled-your_number-"+t).text()&&null!=$("#prefilled-your_number-"+t).text()?(c=c+"~|NAME="+$("#prefilled-your_name-"+t).text()+"|MOBILE="+$("#prefilled-your_number-"+t).text()+"|QTY="+n+"|USERSTATUS=S|",e=$("#prefilled-your_name-"+t).text()):""!=$("#prefilled-dynamic_name-"+t).val()&&(c=c+"~|NAME="+$("#prefilled-dynamic_name-"+t).val()+"|MOBILE="+$("#prefilled-your_number-"+t).text()+"|QTY="+n+"|USERSTATUS=S|",e=$("#prefilled-dynamic_name-"+t).val()),"ticket"==splitType&&l==d)splitType="M";else if("cost"==splitType){s=costDetails.BookMyShow.data["Ticket Cost"][0][n];var o={senderNo:$("#prefilled-your_number-"+t).text(),receiverNo:userMobileNo,amount:s,i:l,len:d,name:e};a.push(o),i=!0,conf.fnSplitCostCall(o.senderNo,o.receiverNo,o.amount,l,d,e),l==d&&(splitType="C")}}else{n=parseInt($("#total_tickets-"+t).text());s=costDetails.BookMyShow.data["Ticket Cost"][0][n],c=c+"~|NAME="+$("#your_name-"+t).val()+"|MOBILE="+$("#your_number-"+t).val()+"|QTY="+n+"|USERSTATUS=S|";o={senderNo:$("#your_number-"+t).val(),receiverNo:userMobileNo,amount:s,i:l,len:d,name:$("#your_name-"+t).val()};a.push(o)}"B"==splitType&&0==continueSplitCost?r=!0:"C"==splitType&&0==i?conf.fnSplitCostCall(o.senderNo,o.receiverNo,o.amount,l,d,o.name):"M"==splitType&&(r=!0)}})),r&&conf.fnSplitMTicketCall(c,a)},conf.fnContinueSplitCost=function(){fromContinueSplitCost=!(splitCostError=!1),BMS.Misc.fnBusy(!0,$(".body"));var e=userDataFromSplitTicketForCost;for(var t in e)conf.fnSplitCostCall(e[t].senderNo,e[t].receiverNo,e[t].amount,e[t].i,e[t].len,e[t].name)},conf.fnSplitCostCall=function(e,t,n,o,i,s){BMS.Misc.fnDoTrans({AppC:global.strWltAppCode,retType:"json",lngTransactionIdentifier:"0",type:"POST",cmd:"INITIATEWALLETTOWALLETTRANSFER",p1:BMS.Storage.get({name:"ld",key:"MEMBERID"}),p2:BMS.Storage.get({name:"ld",key:"LSID"}),p3:"receive",p4:e,p5:t,p6:n,p8:strBookingId,p9:strTransId,blnSupp:!0,fnCC:function(e){costSuccessCount+=1;var t=failedSenderNames.length,n=costSuccessCount+t;if(n==i&&0==splitCostError){if($("#split-status").text("SUCCESS"),doneSplitCost=!0,mticketSuccess){mticketSuccess=!1;var o="B";setTimeout((function(){conf.fnGetMemberHistory(o)}),3e3)}else{fromContinueSplitCost&&(fromContinueSplitCost=!1);o="C";setTimeout((function(){conf.fnGetMemberHistory(o)}),3e3)}costSuccessCount=0}else n==i&&1==splitCostError&&"B"!=splitType?(setTimeout((function(){conf.fnGetMemberHistory(splitType)}),3e3),costSuccessCount=0):n==i&&1==splitCostError&&"B"==splitType&&(mticketSuccess?(mticketSuccess=!1,setTimeout((function(){conf.fnGetMemberHistory("B")}),3e3)):(fromContinueSplitCost&&0==mticketSuccess&&(fromContinueSplitCost=!1),setTimeout((function(){conf.fnGetMemberHistory("C")}),3e3)),costSuccessCount=0)},fnEC:function(e){splitCostError=!0,failedSenderNames.push(s);var t=failedSenderNames.length,n=costSuccessCount+t;n==i&&1==splitCostError&&"B"!=splitType?t<i?(setTimeout((function(){conf.fnGetMemberHistory(splitType)}),3e3),costSuccessCount=0):t==i&&($("#error-type").text("SHARE COST"),$("#error-msg").text(e),$("#cost-error").text("We are unable to process your request for share cost."),BMS.Misc.modal("splitBookingError",!0),BMS.Misc.fnBusy(!1,$(".body")),failedSenderNames=[]):n==i&&1==splitCostError&&"B"==splitType&&(t<i&&1==mticketSuccess?(mticketSuccess=!1,setTimeout((function(){conf.fnGetMemberHistory("B")}),3e3),costSuccessCount=0):1==fromContinueSplitCost&&0==mticketSuccess&&t<i?(fromContinueSplitCost=!1,setTimeout((function(){conf.fnGetMemberHistory("C")}),3e3),costSuccessCount=0):1==fromContinueSplitCost&&0==mticketSuccess&&t==i?(fromContinueSplitCost=!1,$("#error-type").text("SHARE COST"),$("#error-msg").text(e),$("#cost-error").text("We are unable to process your request for share cost."),BMS.Misc.modal("splitBookingError",!0),BMS.Misc.fnBusy(!1,$(".body")),failedSenderNames=[]):t==i&&1==mticketSuccess&&(mticketSuccess&&(mticketSuccess=!1),setTimeout((function(){conf.fnGetMemberHistory("M")}),3e3)))}})},conf.fnPrefilledDetails=function(){BMS.Misc.modal("splitBookingDetailsPrefilled",!0)},conf.fnGetPaymentDetails=function(){BMS.Storage.isset({name:"ld"})||!$("#splitTicketCost").is(":checked")||$("#splitTicketCost").prop("disabled")?BMS.Storage.isset({name:"ld"})&&("B"==BMS.Storage.get({name:"ld",key:"WALLETSTATUS"})||""==BMS.Storage.get({name:"ld",key:"WALLETSTATUS"}))&&$("#splitTicketCost").prop("checked")?(BMS.Storage.set({name:"split-booking",value:!0,storage:"C"}),BMS.Storage.set({name:"beforeSplit-bookingID",value:bIdBeforeSplit,storage:"C"}),BMS.Storage.set({name:"split-transId",value:lngTransId,storage:"C"}),window.location=location.protocol+"//"+location.hostname+"/myprofile/mywallet"):"A"==BMS.Storage.get({name:"ld",key:"WALLETSTATUS"})&&$("#splitTicketCost").prop("checked")&&conf.fnTransactionSplitPaymentDetails():(BMS.SignIn.fnSignIn(!0),null==global.SignInCallBack&&(global.SignInCallBack=[]),global.SignInCallBack.push((function(){setTimeout((function(){conf.fnGetMemberHistory("V")}),1e3),fromGetPaymentMethod=!0})))},conf.fnTransactionSplitPaymentDetails=function(){fromGetPaymentMethod?fromGetPaymentMethod=!1:(BMS.Misc.modal("splitBookingDetailsPrefilled",!0),BMS.Misc.fnBusy(!0,$(".body")));var d=strTransId;BMS.Misc.fnWsData({AppC:global.strWltAppCode,cmd:"GETTRANSACTIONSPLITPAYMENTDETAILS",data:"|TRANSID="+strTransId+"|BOOKINGID="+bIdBeforeSplit+"|",type:"POST",retType:"json",blnSupp:!0,fnCC:function(e){var t=JSON.parse(decodeURIComponent(e));costDetails=t,splitType="cost";var n,o;o=1<(n=totalTickets-1)?"Add up to "+n+" contacts":"Add up to "+n+" contact",$("#prefilled-total-tickets-summary").text("Total - "+t.BookMyShow.data.Quantity+" tickets (Rs. "+t.BookMyShow.data["Total Amount"]+")"),$("#prefilled-remaining-ticket").text(o);for(var i=0,s=($(".prefilled-friend").length,0);s<ticketArr.length;s++){var r;if(ticketArr[s].Trans_lngId==d)if(r=1<parseInt(ticketArr[s].Trans_intQuantity)?" Tickets (Rs. "+costDetails.BookMyShow.data["Ticket Cost"][0][ticketArr[s].Trans_intQuantity]+")":" Ticket (Rs. "+costDetails.BookMyShow.data["Ticket Cost"][0][ticketArr[s].Trans_intQuantity]+")","P"==ticketArr[s].Trans_strUserStatus)$("#receiver-number").text(ticketArr[s].Trans_strUserMobile),$("#prefilled-total-tickets").text(ticketArr[s].Trans_intQuantity),$("#prefilled-total-amount").text(r);else if(""==$("#tickets-0").text())$("#prefilled-your_name-0").text(ticketArr[s].Trans_strUserName),$("#prefilled-your_number-0").text(ticketArr[s].Trans_strUserMobile),$("#tickets-0").text(ticketArr[s].Trans_intQuantity),$("#amount-0").text(r);else{i+=1;var a=document.getElementById("friends-ticket-0"),c=a.cloneNode(!0);c.id="friends-ticket-"+i,$(c).addClass("remove-details"),$(c).find(".name-details").attr("id","prefilled-your_name-"+i),$(c).find(".phone-number").attr("id","prefilled-your_number-"+i),$(c).find(".total-tickets").attr("id","tickets-"+i),$(c).find(".total-amount").attr("id","amount-"+i),$(c).find("#prefilled-your_name-"+i).text(ticketArr[s].Trans_strUserName),$(c).find("#prefilled-your_number-"+i).text(ticketArr[s].Trans_strUserMobile),$(c).find("#tickets-"+i).text(ticketArr[s].Trans_intQuantity),$(c).find("#amount-"+i).text(r),a.parentNode.appendChild(c)}}BMS.Misc.fnBusy(!1,$(".body"))}})},conf.fnGetMemberHistory=function(G){try{var j,e=BMS.Storage.get({name:"ld",key:"MEMBEREMAIL",defVal:""}),t=BMS.Storage.get({name:"ld",key:"LSID",defVal:""}),n=BMS.Storage.get({name:"ld",key:"MEMBERID",defVal:""}),V=strTransId;BMS.Misc.fnWsData({AppC:global.strWltAppCode,cmd:"GETMEMBERHISTORY",email:e,lsid:t,data:"|MEMBERID="+n+"|",blnSupp:!0,retType:"json",fnCC:function(e){for(var t=JSON.parse(decodeURIComponent(e)),n=t.BookMyShow.arrBookingHistory,o=!1,i=0;i<n.length;i++)n[i].TransId==V&&(o=!0);if(void 0,o){if(o=!1,"V"==G)if("B"!=BMS.Storage.get({name:"ld",key:"WALLETSTATUS"})&&""!=BMS.Storage.get({name:"ld",key:"WALLETSTATUS"})||!$("#splitTicketCost").prop("checked"))if(fromGetPaymentMethod){if(fromGetPaymentMethod){BMS.Misc.modal("splitBookingDetailsPrefilled",!0),BMS.Misc.fnBusy(!0,$(".body")),ticketArr=t.BookMyShow.arrSplitMTicket;for(i=totalTickets=0;i<ticketArr.length;i++)ticketArr[i].Trans_lngId==V&&(totalTickets+=parseInt(ticketArr[i].Trans_intQuantity));conf.fnTransactionSplitPaymentDetails()}}else conf.fnSplitBooking();else BMS.Storage.set({name:"split-booking",value:!0,storage:"C"}),BMS.Storage.set({name:"beforeSplit-bookingID",value:bIdBeforeSplit,storage:"C"}),BMS.Storage.set({name:"split-transId",value:lngTransId,storage:"C"}),window.location=location.protocol+"//"+location.hostname+"/myprofile/mywallet";else if("I"==G);else if("X"==G){fnGetBookingInfo();var s=-1;if(0==(w=[]).length)doneSplitCost=!1;else if(0!=w.length)for(var r=0;r<w.length;r++)if(0!=w[r].length&&w[r][0].TransId==V)for(var a in doneSplitCost=!0,w[r])s+=1;var c=-1;ticketArr=t.BookMyShow.arrSplitMTicket;for(i=totalTickets=0;i<ticketArr.length;i++)ticketArr[i].Trans_lngId==V&&(doneSplitTicket=!0,totalTickets+=parseInt(ticketArr[i].Trans_intQuantity),c+=1);if(1==doneSplitCost&&1==doneSplitTicket)$("#btnSplitBooking").remove(),B=1<c?"This booking has been split with "+c+" friends":"This booking has been split with "+c+" friend",$("#no-friends").text(B),$("#booking-done").show();else if(1==doneSplitCost){var d;splitType="ticket",$(".split-cost").css("opacity",.5),$("#splitTicketCost").prop("disabled",!0),$(".already-cost-split-error").show(),$("#btnProceedToDetails").attr("onclick","conf.fnPrefilledDetails();"),$("#btnProceedToDetails").css("opacity",1);for(r=0;r<w.length;r++)0!=w[r].length&&w[r][0].TransId==V&&(d=r);var l=(R=w[d]).length-1;receiversAmount=R[l].Amount,$("#split-type-prefilled").text("SEND TICKET");for(i=totalTickets=0;i<l;i++){if(totalTickets+=parseInt(R[i].NumberOfTickets),U=1<parseInt(R[i].NumberOfTickets)?" Tickets":" Ticket",0==i)null==R[i].UserName?($("#name_block-0").hide(),$("#prefilled-dynamic_name-0").addClass("dynamic-name"),$("#prefilled-dynamic_name-0").show(),$("#btnConfirmPrefilledDetails").attr("onclick",""),$("#btnConfirmPrefilledDetails").css("opacity",.5)):($("#prefilled-your_name-0").text(R[i].UserName),$(Q).find("#prefilled-dynamic_name-0").removeClass("dynamic-name")),$("#prefilled-your_number-0").text(R[i].UserMobile),$("#tickets-0").text(R[i].NumberOfTickets),$("#amount-0").text(U);else(Q=(O=document.getElementById("friends-ticket-0")).cloneNode(!0)).id="friends-ticket-"+i,$(Q).addClass("remove-details"),$(Q).find(".phone-number").attr("id","prefilled-your_number-"+i),$(Q).find(".name-details").attr("id","prefilled-your_name-"+i),$(Q).find(".total-tickets").attr("id","tickets-"+i),$(Q).find(".total-amount").attr("id","amount-"+i),$(Q).find("#name_block-0").attr("id","name_block-"+i),$(Q).find("#prefilled-dynamic_name-0").attr("id","prefilled-dynamic_name-"+i),null==R[i].UserName?($(Q).find("#name_block-"+i).hide(),$(Q).find("#prefilled-dynamic_name-"+i).addClass("dynamic-name"),$(Q).find("#prefilled-dynamic_name-"+i).show(),$("#btnConfirmPrefilledDetails").attr("onclick",""),$("#btnConfirmPrefilledDetails").css("opacity",.5)):($(Q).find("#prefilled-dynamic_name-"+i).removeClass("dynamic-name"),$(Q).find("#prefilled-your_name-"+i).text(R[i].UserName),$(Q).find("#name_block-"+i).show(),$(Q).find("#prefilled-dynamic_name-"+i).hide()),$(Q).find("#prefilled-your_number-"+i).text(R[i].UserMobile),$(Q).find("#tickets-"+i).text(R[i].NumberOfTickets),$(Q).find("#amount-"+i).text(U),O.parentNode.appendChild(Q)}U=1<parseInt(R[l].NumberOfTickets)?" Tickets":" Ticket",$("#receiver-number").text(R[l].UserMobile),$("#prefilled-total-tickets").text(R[l].NumberOfTickets),$("#prefilled-total-amount").text(U);var f,p=(totalTickets+=parseInt(R[l].NumberOfTickets))-1;f=1<p?"Add up to "+p+" contacts":"Add up to "+p+" contact",$("#prefilled-total-tickets-summary").text("Total - "+totalTickets+" tickets"),$("#prefilled-remaining-ticket").text(f),B=1<s?"You have shared cost with "+s+" friends":"You have shared cost with "+s+" friend",$("#no-friends").text(B),$("#booking-done").show(),BMS.Misc.fnBusy(!1,$(".body"))}else if(1==doneSplitTicket){splitType="cost",$("#btnProceedToDetails").attr("onclick"," conf.fnGetPaymentDetails();"),$("#btnProceedToDetails").css("opacity",1),B=1<c?"You have sent individual m-tickets to "+c+" friends":"You have sent individual m-ticket to "+c+" friend",$("#no-friends").text(B),$("#booking-done").show(),$(".split-mticket").css("opacity",.5),$("#sendMtickets").prop("disabled",!0),$(".already-ticket-split-error").show(),$("#split-type-prefilled").text("SPLIT TICKET COST")}conf.fnGetWalletDetails()}else if("C"==G){var u=[];for(s=-1,r=0;r<u.length;r++)if(0!=u[r].length&&u[r][0].TransId==V)for(var a in u[j=r])s+=1;for(l=(R=u[j]).length-1,i=0;i<l;i++){if(R[i].UserName?(L=R[i].UserName,F=R[i].UserMobile):(L=R[i].UserMobile,F=""),0==i)$("#csuccess-friend-name-0").text(L),$("#csuccess-friend-cost-0").text("Rs. "+R[i].AmountRequested),$("#csuccess-friend-number-0").text(F);else(Q=(O=document.getElementById("friends-cost-0")).cloneNode(!0)).id="friends-cost-"+i,$(Q).addClass("remove-friend"),$(Q).find(".friend-name").attr("id","csuccess-friend-name-"+i),$(Q).find(".no-tickets").attr("id","csuccess-friend-cost-"+i),$(Q).find(".friend-number").attr("id","csuccess-friend-number-"+i),$(Q).find("#csuccess-friend-name-"+i).text(L),$(Q).find("#csuccess-friend-cost-"+i).text("Rs. "+R[i].AmountRequested),$(Q).find("#csuccess-friend-number-"+i).text(F),O.parentNode.appendChild(Q)}if($("#csuccess-cost").text("Rs. "+R[l].Amount),$("#csuccess-number").text(R[l].UserMobile),$("#mticket-success-summary").hide(),$("#success-summary").hide(),$("#cost-success-summary").show(),0!=failedSenderNames.length){var m=failedSenderNames.toString();$("#cost-failure-names").text(m),$("#share-cost-failure").show()}else $("#share-cost-failure").hide();conf.fnGetMemberHistory("X"),BMS.Misc.modal("splitBookingSuccess",!0),BMS.Misc.fnBusy(!1,$(".body"))}else if("M"==G){var M=0,h=t.BookMyShow.arrSplitMTicket,b=0;for(i=0;i<h.length;i++){if(h[i].Trans_lngId==V)if(M+=1,U=1<parseInt(h[i].Trans_intQuantity)?h[i].Trans_intQuantity+" Tickets":h[i].Trans_intQuantity+" Ticket","P"==h[i].Trans_strUserStatus)$("#msuccess-tickets").text(U),$("#msuccess-bookingId").text("Booking ID: "+h[i].Trans_strBookingId),$("#msuccess-number").text(h[i].Trans_strUserMobile);else if(0==b)b+=1,$("#msuccess-friend-name-0").text(h[i].Trans_strUserName),$("#msuccess-friend-tickets-0").text(U),$("#msuccess-friend-bookingId-0").text("Booking ID: "+h[i].Trans_strBookingId),$("#msuccess-friend-number-0").text(h[i].Trans_strUserMobile);else{(Q=(O=document.getElementById("friends-mticket-0")).cloneNode(!0)).id="friends-mticket-"+b,$(Q).addClass("remove-friend"),$(Q).find(".friend-name").attr("id","msuccess-friend-name-"+b),$(Q).find(".no-tickets").attr("id","msuccess-friend-tickets-"+b),$(Q).find(".phone-no").attr("id","msuccess-friend-number-"+b),$(Q).find(".your-bId").attr("id","msuccess-friend-bookingId-"+b),$(Q).find("#msuccess-friend-name-"+b).text(h[i].Trans_strUserName),$(Q).find("#msuccess-friend-tickets-"+b).text(U),$(Q).find("#msuccess-friend-number-"+b).text(h[i].Trans_strUserMobile),$(Q).find("#msuccess-friend-bookingId-"+b).text("Booking ID: "+h[i].Trans_strBookingId),O.parentNode.appendChild(Q),b+=1}}if(0<M){if($("#cost-success-summary").hide(),$("#success-summary").hide(),$("#mticket-success-summary").show(),0!=failedSenderNames.length){var g=failedSenderNames.toString();$("#mticket-cost-failure-names").text(g),$("#mticket-cost-failure").show()}conf.fnGetMemberHistory("X"),BMS.Misc.modal("splitBookingSuccess",!0),BMS.Misc.fnBusy(!1,$(".body"))}else conf.fnGetMemberHistory("M")}else if("B"==G){u=[],h=t.BookMyShow.arrSplitMTicket;var y=0,S=!1,k=!1,v=[];for(r=0;r<u.length;r++)0!=u[r].length&&u[r][0].TransId==V&&(j=r,S=!0);for(var C=0,T=0;T<h.length;T++)h[T].Trans_lngId==V&&(C+=1,"P"!=h[T].Trans_strUserStatus&&(y+=1,k=!0));if(1==k&&1==S&&$("#btnSplitBooking").remove(),0!=y&&1==k&&1==S)B=0<y?"This booking has been split with "+y+" friends":"This booking has been split with "+y+" friend",$("#no-friends").text(B),$("#booking-done").show();else if(1==k){var B;B=0<y?"You have sent individual m-tickets to "+y+" friends":"You have sent individual m-ticket to "+y+" friend",$("#no-friends").text(B),$("#booking-done").show()}l=(R=u[j]).length-1;var _=!1,x=!1;for(T=0;T<h.length;T++){if(h[T].Trans_lngId==V)if(C>R.length)if(_=!0,"P"!=h[T].Trans_strUserStatus)if(U=1<parseInt(h[T].Trans_intQuantity)?h[T].Trans_intQuantity+" Tickets":h[T].Trans_intQuantity+" Ticket",P=h[T].Trans_strUserName+":"+h[T].Trans_strUserMobile,0==x)x=!0,$("#friend-name-0").text(h[T].Trans_strUserName),$("#friend-tickets-0").text(U),$("#friend-tel-no-0").text(h[T].Trans_strUserMobile),$("#friend-bookingId-0").text("Booking ID: "+h[T].Trans_strBookingId),$("#friends-booking-0").find(".amount").text(""),$("#CFsuccess-friend-name-0").text(h[T].Trans_strUserName),$("#CFsuccess-friend-bookingId-0").text("Booking ID: "+h[T].Trans_strBookingId),$("#CFsuccess-friend-tickets-0").text(U),$("#CFsuccess-friend-number-0").text(h[T].Trans_strUserMobile),$("#friends-CFticket-0").css("display","block"),$("#friends-booking-0").css("display","none"),v.push(P);else(Q=(O=document.getElementById("friends-booking-0")).cloneNode(!0)).id="friends-booking-"+T,$(Q).addClass("remove-friend"),$(Q).find(".friend-name").attr("id","friend-name-"+T),$(Q).find(".no-tickets").attr("id","friend-tickets-"+T),$(Q).find(".your-bId").attr("id","friend-bookingId-"+T),$(Q).find(".your-amount").attr("id","friend-cost-"+T),$(Q).find(".phone-no").attr("id","friend-tel-no-"+T),$(Q).find("#friend-cost-"+T).text(""),$(Q).find(".amount").text(""),$(Q).find("#friend-name-"+T).text(h[T].Trans_strUserName),$(Q).find("#friend-bookingId-"+T).text("Booking ID: "+h[T].Trans_strBookingId),$(Q).find("#friend-tickets-"+T).text(U),$(Q).find("#friend-tel-no-"+T).text(h[T].Trans_strUserMobile),$(Q).css("display","none"),O.parentNode.appendChild(Q),(Q=(O=document.getElementById("friends-CFticket-0")).cloneNode(!0)).id="friends-CFticket-"+T,$(Q).addClass("remove-friend"),$(Q).find(".friend-name").attr("id","CFsuccess-friend-name-"+T),$(Q).find(".no-tickets").attr("id","CFsuccess-friend-tickets-"+T),$(Q).find(".your-bId").attr("id","CFsuccess-friend-bookingId-"+T),$(Q).find(".phone-no").attr("id","CFsuccess-friend-number-"+T),$(Q).find("#CFsuccess-friend-name-"+T).text(h[T].Trans_strUserName),$(Q).find("#CFsuccess-friend-bookingId-"+T).text("Booking ID: "+h[T].Trans_strBookingId),$(Q).find("#CFsuccess-friend-tickets-"+T).text(U),$(Q).find("#CFsuccess-friend-number-"+T).text(h[T].Trans_strUserMobile),$(Q).css("display","block"),O.parentNode.appendChild(Q),v.push(P);else $("#your-bookingId").text("Booking ID: "+h[T].Trans_strBookingId),U=1<parseInt(h[T].Trans_intQuantity)?h[T].Trans_intQuantity+" Tickets":h[T].Trans_intQuantity+" Ticket",$("#your-tickets").text(U);else if(C==R.length){for(i=0;i<l;i++){if(h[T].Trans_strUserMobile==R[i].UserMobile&&"P"!=h[T].Trans_strUserStatus)if(U=1<parseInt(h[T].Trans_intQuantity)?h[T].Trans_intQuantity+" Tickets":h[T].Trans_intQuantity+" Ticket",0==x)x=!0,$("#friend-name-0").text(h[T].Trans_strUserName),$("#friend-cost-0").text("Rs. "+R[i].AmountRequested),$("#friend-tickets-0").text(U),$("#friend-tel-no-0").text(h[T].Trans_strUserMobile),$("#friend-bookingId-0").text("Booking ID: "+h[T].Trans_strBookingId),$("#friends-booking-0").css("display","block"),$("#friends-CFticket-0").css("display","none");else(Q=(O=document.getElementById("friends-booking-0")).cloneNode(!0)).id="friends-booking-"+i,$(Q).addClass("remove-friend"),$(Q).find(".friend-name").attr("id","friend-name-"+i),$(Q).find(".no-tickets").attr("id","friend-tickets-"+i),$(Q).find(".your-bId").attr("id","friend-bookingId-"+i),$(Q).find(".your-amount").attr("id","friend-cost-"+i),$(Q).find(".phone-no").attr("id","friend-tel-no-"+i),$(Q).find("#friend-name-"+i).text(h[T].Trans_strUserName),$(Q).find("#friend-cost-"+i).text("Rs. "+R[i].AmountRequested),$(Q).find("#friend-bookingId-"+i).text("Booking ID: "+h[T].Trans_strBookingId),$(Q).find("#friend-tickets-"+i).text(U),$(Q).find("#friend-tel-no-"+i).text(h[T].Trans_strUserMobile),$(Q).css("display","block"),O.parentNode.appendChild(Q);else"P"==h[T].Trans_strUserStatus&&$("#your-bookingId").text("Booking ID: "+h[T].Trans_strBookingId)}U=1<parseInt(R[l].NumberOfTickets)?R[l].NumberOfTickets+" Tickets":R[l].NumberOfTickets+" Ticket",$("#your-tickets").text(U)}}if(_){var I=[];$.each($(".friends-contact"),(function(){for(var e=this.id.split("-"),t=0;t<l;t++)if($(this).text()==R[t].UserMobile){$("#friend-cost-"+e[3]).text("Rs. "+R[t].AmountRequested),$("#friends-booking-"+e[3]).find(".amount").text("Amount"),$("#friends-CFticket-"+e[3]).hide(),$("#friends-booking-"+e[3]).show();var n=$("#friend-name-"+e[3]).text()+":"+$("#friend-tel-no-"+e[3]).text();I.push(n)}}));for(var D=$(v).not(I).get(),A=[],E=0;E<D.length;E++){if(""!=(m=D[E].split(":"))[0]&&""!=m[0].trim()){var N=" "+m[0];A.push(N)}else{N=" "+m[1];A.push(N)}}A=A.toString(),$("#booking-failure-names").text(A),$("#booking-cost-failure").show()}$("#your-cost").text("Rs. "+R[l].Amount),$("#tel-no").text(R[l].UserMobile),$("#mticket-success-summary").hide(),$("#cost-success-summary").hide(),$("#success-summary").show(),0!=failedSenderNames.length&&(failedSenderNames=[]),BMS.Misc.modal("splitBookingSuccess",!0),BMS.Misc.fnBusy(!1,$(".body"))}else if("S"==G){var w;if(0==(w=[]).length)doneSplitCost=!1;else if(0!=w.length)for(r=0;r<w.length;r++)0!=w[r].length&&w[r][0].TransId==V&&(doneSplitCost=!0);ticketArr=t.BookMyShow.arrSplitMTicket;for(i=0;i<ticketArr.length;i++)ticketArr[i].Trans_lngId==V&&(doneSplitTicket=!0);if(1==doneSplitCost&&1==doneSplitTicket)if(0==dontCloneFriendsBoth){dontCloneFriendsBoth=!0;for(u=[],h=t.BookMyShow.arrSplitMTicket,v=[],r=0;r<u.length;r++)0!=u[r].length&&u[r][0].TransId==V&&(j=r);for(C=0,T=0;T<h.length;T++)h[T].Trans_lngId==V&&(C+=1);for(l=(R=u[j]).length-1,_=!1,x=!1,T=0;T<h.length;T++){var P;if(h[T].Trans_lngId==V)if(C>R.length)if(_=!0,"P"!=h[T].Trans_strUserStatus)if(U=1<parseInt(h[T].Trans_intQuantity)?h[T].Trans_intQuantity+" Tickets":h[T].Trans_intQuantity+" Ticket",P=h[T].Trans_strUserName+":"+h[T].Trans_strUserMobile,0==x)x=!0,$("#friend-name-0").text(h[T].Trans_strUserName),$("#friend-tickets-0").text(U),$("#friend-tel-no-0").text(h[T].Trans_strUserMobile),$("#friend-bookingId-0").text("Booking ID: "+h[T].Trans_strBookingId),$("#friends-booking-0").find(".amount").text(""),$("#CFsuccess-friend-name-0").text(h[T].Trans_strUserName),$("#CFsuccess-friend-bookingId-0").text("Booking ID: "+h[T].Trans_strBookingId),$("#CFsuccess-friend-tickets-0").text(U),$("#CFsuccess-friend-number-0").text(h[T].Trans_strUserMobile),$("#friends-CFticket-0").css("display","block"),$("#friends-booking-0").css("display","none"),v.push(P);else(Q=(O=document.getElementById("friends-booking-0")).cloneNode(!0)).id="friends-booking-"+T,$(Q).find(".friend-name").attr("id","friend-name-"+T),$(Q).find(".no-tickets").attr("id","friend-tickets-"+T),$(Q).find(".your-bId").attr("id","friend-bookingId-"+T),$(Q).find(".your-amount").attr("id","friend-cost-"+T),$(Q).find(".phone-no").attr("id","friend-tel-no-"+T),$(Q).find("#friend-cost-"+T).text(""),$(Q).find(".amount").text(""),$(Q).find("#friend-name-"+T).text(h[T].Trans_strUserName),$(Q).find("#friend-bookingId-"+T).text("Booking ID: "+h[T].Trans_strBookingId),$(Q).find("#friend-tickets-"+T).text(U),$(Q).find("#friend-tel-no-"+T).text(h[T].Trans_strUserMobile),$(Q).css("display","none"),O.parentNode.appendChild(Q),(Q=(O=document.getElementById("friends-CFticket-0")).cloneNode(!0)).id="friends-CFticket-"+T,$(Q).find(".friend-name").attr("id","CFsuccess-friend-name-"+T),$(Q).find(".no-tickets").attr("id","CFsuccess-friend-tickets-"+T),$(Q).find(".your-bId").attr("id","CFsuccess-friend-bookingId-"+T),$(Q).find(".phone-no").attr("id","CFsuccess-friend-number-"+T),$(Q).find("#CFsuccess-friend-name-"+T).text(h[T].Trans_strUserName),$(Q).find("#CFsuccess-friend-bookingId-"+T).text("Booking ID: "+h[T].Trans_strBookingId),$(Q).find("#CFsuccess-friend-tickets-"+T).text(U),$(Q).find("#CFsuccess-friend-number-"+T).text(h[T].Trans_strUserMobile),$(Q).css("display","block"),O.parentNode.appendChild(Q),v.push(P);else $("#your-bookingId").text("Booking ID: "+h[T].Trans_strBookingId),U=1<parseInt(h[T].Trans_intQuantity)?h[T].Trans_intQuantity+" Tickets":h[T].Trans_intQuantity+" Ticket",$("#your-tickets").text(U);else if(C==R.length){for(i=0;i<l;i++){if(h[T].Trans_strUserMobile==R[i].UserMobile&&"P"!=h[T].Trans_strUserStatus)if(U=1<parseInt(h[T].Trans_intQuantity)?h[T].Trans_intQuantity+" Tickets":h[T].Trans_intQuantity+" Ticket",0==x)x=!0,$("#friend-name-0").text(h[T].Trans_strUserName),$("#friend-cost-0").text("Rs. "+R[i].AmountRequested),$("#friend-tickets-0").text(U),$("#friend-tel-no-0").text(h[T].Trans_strUserMobile),$("#friend-bookingId-0").text("Booking ID: "+h[T].Trans_strBookingId),$("#friends-booking-0").css("display","block"),$("#friends-CFticket-0").css("display","none");else(Q=(O=document.getElementById("friends-booking-0")).cloneNode(!0)).id="friends-booking-"+i,$(Q).find(".friend-name").attr("id","friend-name-"+i),$(Q).find(".no-tickets").attr("id","friend-tickets-"+i),$(Q).find(".your-bId").attr("id","friend-bookingId-"+i),$(Q).find(".your-amount").attr("id","friend-cost-"+i),$(Q).find(".phone-no").attr("id","friend-tel-no-"+i),$(Q).find("#friend-name-"+i).text(h[T].Trans_strUserName),$(Q).find("#friend-cost-"+i).text("Rs. "+R[i].AmountRequested),$(Q).find("#friend-bookingId-"+i).text("Booking ID: "+h[T].Trans_strBookingId),$(Q).find("#friend-tickets-"+i).text(U),$(Q).find("#friend-tel-no-"+i).text(h[T].Trans_strUserMobile),$(Q).css("display","block"),O.parentNode.appendChild(Q);else"P"==h[T].Trans_strUserStatus&&$("#your-bookingId").text("Booking ID: "+h[T].Trans_strBookingId)}U=1<parseInt(R[l].NumberOfTickets)?R[l].NumberOfTickets+" Tickets":R[l].NumberOfTickets+" Ticket",$("#your-tickets").text(U)}}if(_){I=[];$.each($(".friends-contact"),(function(){for(var e=this.id.split("-"),t=0;t<l;t++)if($(this).text()==R[t].UserMobile){$("#friend-cost-"+e[3]).text("Rs. "+R[t].AmountRequested),$("#friends-booking-"+e[3]).find(".amount").text("Amount"),$("#friends-CFticket-"+e[3]).hide(),$("#friends-booking-"+e[3]).show();var n=$("#friend-name-"+e[3]).text()+":"+$("#friend-tel-no-"+e[3]).text();I.push(n)}}));for(D=$(v).not(I).get(),A=[],E=0;E<D.length;E++){if(""!=(m=D[E].split(":"))[0]&&""!=m[0].trim()){N=" "+m[0];A.push(N)}else{N=" "+m[1];A.push(N)}}A=A.toString(),$("#booking-failure-names").text(A),$("#booking-cost-failure").show()}$("#your-cost").text("Rs. "+R[l].Amount),$("#tel-no").text(R[l].UserMobile),$("#mticket-success-summary").hide(),$("#cost-success-summary").hide(),$("#success-summary").show(),BMS.Misc.modal("splitBookingSuccess",!0),BMS.Misc.fnBusy(!1,$(".body"))}else BMS.Misc.fnBusy(!1,$(".body"));else if(1==doneSplitCost)if(0==dontCloneFriendsCost){dontCloneFriendsCost=!0;for(u=[],r=0;r<u.length;r++)0!=u[r].length&&u[r][0].TransId==V&&(j=r);var R,L,F;for(l=(R=u[j]).length-1,i=0;i<l;i++){if(R[i].UserName?(L=R[i].UserName,F=R[i].UserMobile):(L=R[i].UserMobile,F=""),0==i)$("#csuccess-friend-name-0").text(L),$("#csuccess-friend-cost-0").text("Rs. "+R[i].AmountRequested),$("#csuccess-friend-number-0").text(F);else(Q=(O=document.getElementById("friends-cost-0")).cloneNode(!0)).id="friends-cost-"+i,$(Q).find(".friend-name").attr("id","csuccess-friend-name-"+i),$(Q).find(".no-tickets").attr("id","csuccess-friend-cost-"+i),$(Q).find(".friend-number").attr("id","csuccess-friend-number-"+i),$(Q).find("#csuccess-friend-name-"+i).text(L),$(Q).find("#csuccess-friend-cost-"+i).text("Rs. "+R[i].AmountRequested),$(Q).find("#csuccess-friend-number-"+i).text(F),O.parentNode.appendChild(Q)}$("#csuccess-cost").text("Rs. "+R[l].Amount),$("#csuccess-number").text(R[l].UserMobile),$("#mticket-success-summary").hide(),$("#success-summary").hide(),$("#share-cost-failure").hide(),$("#cost-success-summary").show(),BMS.Misc.fnBusy(!1,$(".body"))}else BMS.Misc.fnBusy(!1,$(".body"));else if(1==doneSplitTicket)if(0==dontCloneFriendsTicket){dontCloneFriendsTicket=!0;for(h=t.BookMyShow.arrSplitMTicket,b=0,i=0;i<h.length;i++){var U;if(h[i].Trans_lngId==V)if(U=1<parseInt(h[i].Trans_intQuantity)?h[i].Trans_intQuantity+" Tickets":h[i].Trans_intQuantity+" Ticket","P"==h[i].Trans_strUserStatus)$("#msuccess-tickets").text(U),$("#msuccess-bookingId").text("Booking ID: "+h[i].Trans_strBookingId),$("#msuccess-number").text(h[i].Trans_strUserMobile);else if(0==b)b+=1,$("#msuccess-friend-name-0").text(h[i].Trans_strUserName),$("#msuccess-friend-tickets-0").text(U),$("#msuccess-friend-bookingId-0").text("Booking ID: "+h[i].Trans_strBookingId),$("#msuccess-friend-number-0").text(h[i].Trans_strUserMobile);else{var O,Q;(Q=(O=document.getElementById("friends-mticket-0")).cloneNode(!0)).id="friends-mticket-"+b,$(Q).find(".friend-name").attr("id","msuccess-friend-name-"+b),$(Q).find(".no-tickets").attr("id","msuccess-friend-tickets-"+b),$(Q).find(".phone-no").attr("id","msuccess-friend-number-"+b),$(Q).find(".your-bId").attr("id","msuccess-friend-bookingId-"+b),$(Q).find("#msuccess-friend-name-"+b).text(h[i].Trans_strUserName),$(Q).find("#msuccess-friend-tickets-"+b).text(U),$(Q).find("#msuccess-friend-number-"+b).text(h[i].Trans_strUserMobile),$(Q).find("#msuccess-friend-bookingId-"+b).text("Booking ID: "+h[i].Trans_strBookingId),O.parentNode.appendChild(Q),b+=1}}$("#cost-success-summary").hide(),$("#success-summary").hide(),$("#mticket-success-summary").show(),$("#mticket-cost-failure").hide(),BMS.Misc.fnBusy(!1,$(".body"))}else BMS.Misc.fnBusy(!1,$(".body"))}}else $(".qyt").html("Quantity: "+strQuantity),$(".__qrcode img").attr("src","https://"+location.host+"/secure/barcode/?IsImage=Y&strBarcodeType=qrcode&strBarcodeTxt="+bIdBeforeSplit+"&intHeight=100&intWidth=100"),$(".__booking-id").html("Booking ID <br> <strong>"+bIdBeforeSplit+"</strong>"),$("#btnSplitBooking").remove(),$("#booking-done").hide()}})}catch(e){BMS.Misc.fnErr({fnName:"conf.fnGetMemberHistory",err:e})}},conf.fnBookingSummary=function(){BMS.Misc.fnBusy(!0,$(".body")),BMS.Misc.modal("splitBookingSuccess",!0),$(".remove-friend").remove(),$("#cost-success-summary").is(":visible")||$("#success-summary").is(":visible")||$("#mticket-success-summary").is(":visible")||$("#success-summary").show(),BMS.Storage.isset({name:"ld"})?conf.fnGetMemberHistory("S"):(doNotShowSumary=!(nonLoginSplitTicket=!0),fnGetBookingInfo())},conf.fnSplitMTicketCall=function(e,n){try{BMS.Misc.fnDoTrans({AppC:global.strWltAppCode,retType:"json",transId:strTransId,type:"POST",cmd:"SPLITMTICKET",p1:e,p2:strBookingId,blnSupp:!0,fnCC:function(e){if(fnGetBookingInfo(),"B"==splitType)for(var t in mticketSuccess=!0,n)conf.fnSplitCostCall(n[t].senderNo,n[t].receiverNo,n[t].amount,n[t].i,n[t].len,n[t].name);else BMS.Storage.isset({name:"ld"})?setTimeout((function(){conf.fnGetMemberHistory(splitType)}),3e3):(doNotShowSumary=!(nonLoginSplitTicket=!0),fnGetBookingInfo())},fnEC:function(e){"B"==splitType?(mticketSuccess=!1,BMS.Misc.modal("splitMTicketError",!0),BMS.Misc.fnBusy(!1,$(".body")),userDataFromSplitTicketForCost=n):($("#cost-error").text("We are unable to process your request for 'Send Tickets'."),$("#error-msg").text(e),$("#error-type").text("SEND TICKETS"),BMS.Misc.modal("splitBookingError",!0),BMS.Misc.fnBusy(!1,$(".body")))}})}catch(e){BMS.Misc.fnErr({fnName:"conf.fnSplitMTicketCall",err:e})}},conf.fnTerminateSession=function(){$(".remove-details").remove(),BMS.Misc.modal("splitMTicketError",!1)},conf.fnDisplayLimit=function(){var e=totalTickets-1;sendTicket?sendTicket&&(1<e?$("#split-tickets-count").text("You can send up to "+e+" m-tickets to your friends."):$("#split-tickets-count").text("You can send up to "+e+" m-ticket to your friend.")):1<e?$("#split-tickets-count").text("You can split cost for up to "+e+" tickets."):$("#split-tickets-count").text("You can split cost for up to "+e+" ticket."),$(".split-exceeded-error").show(),setTimeout((function(){$(".split-exceeded-error").hide()}),5e3)},conf.fnSplitBookingSuccess=function(){try{BMS.Misc.modal("splitBookingSuccess",!0)}catch(e){BMS.Misc.fnErr({fnName:"conf.fnSplitBookingSuccess",err:e})}},conf.fnValidateInput=function(e){try{1==e.shiftKey&&e.preventDefault(),48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=105||8==e.keyCode||9==e.keyCode||37==e.keyCode||39==e.keyCode||46==e.keyCode||110==e.keyCode||86==e.keyCode||e.preventDefault(),110==e.keyCode&&e.preventDefault()}catch(e){BMS.Misc.fnErr({fnName:"conf.fnValidateInput",err:e})}},conf.fnCheckInput=function(e){try{1==e.shiftKey&&e.preventDefault(),65<=e.keyCode&&e.keyCode<=90||8==e.keyCode||9==e.keyCode||32==e.keyCode||39==e.keyCode||46==e.keyCode||110==e.keyCode||86==e.keyCode||e.preventDefault(),110==e.keyCode&&e.preventDefault()}catch(e){BMS.Misc.fnErr({fnName:"conf.fnCheckInput",err:e})}},$(document).ready((function(){if(userMobileNo=""!=BMS.Storage.get({name:"ld",key:"MOBILE"})?BMS.Storage.get({name:"ld",key:"MOBILE"}):strMemberMobile,"MT"==strEventType||"N"!=cinemaHasMticketSplit&&"N"!=userHasMticket||(void 0,$("#btnSplitBooking").remove()),BMS.Storage.get({name:"split-booking"})&&(BMS.Storage.del({name:"split-booking"}),conf.fnSplitBooking()),BMS.Storage.isset({name:"ld"})){conf.fnGetMemberHistory("X")}else void 0,doNotShowSumary=nonLoginSplitTicket=!0,fnGetBookingInfo();1==parseInt(strQuantity)&&$("#btnSplitBooking").remove(),$.each($(".no"),(function(){$("#"+this.id).on("paste",(function(){setTimeout('$(".no").keyup();',200)}))})),$(document).on("blur",".no",(function(){$.each($(".no"),(function(){if($(this).is(":visible")){if(10!=$("#"+this.id).val().length){var e=this.id.split("-");$("#mobile_error-"+e[1]).show(),$("#your_number-"+e[1]).addClass("changeBorder")}conf.fnValidateDetails(this.id)}}))})),$(document).on("paste",".user-name",(function(){event.preventDefault()})),$(".__dismiss").click((function(){count=0,splitCostError=!1,$(".remove-details").remove(),$("#splitTicketCost").prop("checked",!0),$("#sendMtickets").prop("checked",!0),ticketQty=totalTickets-1,$("#add-another-friend").removeClass("_disabled"),$("#add-another-friend").css("opacity",1),$("#add-another-friend").attr("onclick","conf.fnAddFriend();"),$(".incr-ticket").attr("onclick","conf.fnIncrTicket(this.id);"),$(".incr-ticket").removeClass("_disabled"),$(".incr-ticket").css("opacity",1),BMS.Misc.fnBusy(!1,$(".body")),$("#input-container-0").hide(),$("#delete_confirmation-0").hide(),$("#details_container-0").show(),$("#tickets-0").text("");conf.fnGetMemberHistory("X")})),$(".__checkbox").change((function(){$("#splitTicketCost").prop("disabled")&&!$("#sendMtickets").prop("checked")?($("#btnProceedToDetails").attr("onclick",""),$("#btnProceedToDetails").css("opacity",.5)):$("#sendMtickets").prop("disabled")&&!$("#splitTicketCost").prop("checked")?($("#btnProceedToDetails").attr("onclick",""),$("#btnProceedToDetails").css("opacity",.5)):$("#sendMtickets").prop("checked")||$("#splitTicketCost").prop("checked")?$("#splitTicketCost").prop("disabled")&&$("#sendMtickets").prop("disabled")?($("#btnProceedToDetails").attr("onclick",""),$("#btnProceedToDetails").css("opacity",.5)):1!=$(".cinema-error").is(":visible")&&1!=$(".box-office-pickup-error").is(":visible")||1!=$(".already-cost-split-error").is(":visible")?(1==$(".already-ticket-split-error").is(":visible")&&$("#splitTicketCost").prop("checked")&&!$("#splitTicketCost").prop("disabled")&&0==$(".already-cost-split-error").is(":visible")?$("#btnProceedToDetails").attr("onclick","conf.fnGetPaymentDetails();"):$("#btnProceedToDetails").attr("onclick","conf.fnSplitBookingDetails();"),$("#btnProceedToDetails").css("opacity",1)):($("#btnProceedToDetails").attr("onclick",""),$("#btnProceedToDetails").css("opacity",.5)):($("#btnProceedToDetails").attr("onclick",""),$("#btnProceedToDetails").css("opacity",.5))}))})),conf.firePurchaseCompletedEvent=function(){try{var e=new Date,t={eventName:"purchase_completion_viewed",event_name:"purchase_completion_viewed",event_type:"screen_view",screen_name:"purchase_completion",product:BMS.Misc.fnGetEventProductType(strEventType),experiment:"",timestamp:e.toISOString(),event_code:strEventCode,event_group:"",title:strEventName,venue_code:strVenueCode,show_session_id:lngSessionId};t=$.extend({},t,BMS.Analytics.commonClickStreamParams()),bmsMQTTClient&&bmsMQTTClient.push(t)}catch(e){BMS.Misc.fnErr({fnName:"conf.firePurchaseCompletedEvent",err:e})}};